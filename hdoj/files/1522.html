<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 1522</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Marriage is Stable</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 275&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 177<br><font color=red>Special Judge</font></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Albert, Brad, Chuck are happy bachelors who are in love with Laura, Marcy, Nancy. They all have three choices. But in fact, they do have some preference in mind. Say Albert, he likes Laura best, but that doesn't necesarily mean Laura likes him. Laura likes Chuck more than Albert. So if Albert can't marry Laura, he thinks Nancy a sensible choice. For Albert, he orders the girls Laura &gt; Nancy &gt; Marcy.<br><br>For the boys:<br><br>Albert: Laura &gt; Nancy &gt; Marcy<br>Brad: Marcy &gt; Nancy &gt; Laura<br>Chuck: Laura &gt; Marcy &gt; Nancy<br><br>For the girls:<br><br>Laura: Chuck &gt; Albert &gt; Brad<br>Marcy: Albert &gt; Chuck &gt; Brad<br>Nancy: Brad &gt; Albert &gt; Chuck<br><br>But if they were matched randomly, such as<br><br>Albert &lt;-&gt; Laura <br>Brad &lt;-&gt; Marcy<br>Chuck &lt;-&gt; Nancy<br><br>they would soon discover it's not a nice solution. For Laura, she likes Chuck instead of Albert. And what's more, Chuck likes Laura better than Nancy. So Laura and Chuck are likely to come together, leaving poor Albert and Nancy.<br><br>Now it's your turn to find a stable marriage. A stable marriage means for any boy G and girl M, with their choice m[G] and m[M], it will not happen that rank(G, M) &lt; rank(G, m[G]£©and rank(M, G) &lt; rank(M, m[M]).<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Each case starts with an integer n (1 &lt;= n &lt;= 500), the number of matches to make.<br><br>The following n lines contain n + 1 names each, the first being name of the boy, and rest being the rank of the girls.<br><br>The following n lines are the same information for the girls.<br><br>Process to the end of file.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>If there is a stable marriage, print n lines with two names on each line. You can choose any one if there are multiple solution. Print &quot;Impossible&quot; otherwise.<br><br>Print a blank line after each test.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
Albert Laura Nancy Marcy
Brad Marcy Nancy Laura
Chuck Laura Marcy Nancy
Laura Chuck Albert Brad
Marcy Albert Chuck Brad
Nancy Brad Albert Chuck</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Albert Nancy
Brad Marcy
Chuck Laura</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>CHENG, Long</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=ZOJ&source=1&searchmode=source'> ZOJ </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>8600</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=1522'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=1522'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=1522">Discuss</a> | <a href='note/note.php?pid=1522'>Note</a><br></td></tr></div></body></html>