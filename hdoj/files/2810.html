<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2810</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Hyperspace</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 3000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 432&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 59<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Hyperspace ,A Euclidean space of dimension greater than three (the original meaning of the word hyperspace, common in late nineteenth century British books, sometimes used in paranormal context, but which has become rarer since then). Minkowski space, a concept, often referred to by science fiction writers as hyperspace that refers to the four-dimensional space-time of special relativity.<br><img src=http://acm.hdu.edu.cn/data/images/C190-1002-1.jpg> <img src=http://acm.hdu.edu.cn/data/images/C190-1002-2.jpg> <br>Here we define a ¡°Hyperspace¡± as a set of points in three-dimensional space. We define a function to describe its ¡°Hyperspace Value¡±<br><img src=http://acm.hdu.edu.cn/data/images/C190-1002-3.jpg> <br>Every vi (0&lt;=i&lt;=k) could be describe in three-dimensional reference system, say v0 (1, 2, 3)<br>For the following question, we will have to deal with the ¡°Hyperspaces¡±, you may assume that the number of ¡°Hyperspace¡± is always no larger than 100.<br>As we say above, we give every ¡°Hyperspace¡± an ¡°ID¡± to identify it.<br>If you want to connect two points in two different ¡°Hyperspaces¡±, it will cost you F to build the connection. F can be defined as the following expression:<br><img src=http://acm.hdu.edu.cn/data/images/C190-1002-4.jpg><br>In addition, you can only create at most one connection between any two ¡°Hyperspaces¡±.<br>If you want to connect two points in the same ¡°Hyperspaces¡± whose ¡°ID¡± is k, it will cost you G to build the connection. G can be defined as the following expression:<br><img src=http://acm.hdu.edu.cn/data/images/C190-1002-5.jpg><br>Here <br><img src=http://acm.hdu.edu.cn/data/images/C190-1002-6.jpg><br>Now your task is quite easy. <br>AekdyCoin gives you n ¡°Hyperspaces¡±.<br>Then he gives you information about all the points in the ¡°Hyperspaces¡±<br>Now he wants to know the minimal cost to connect all the points in all ¡°Hyperspaces¡±<br><br><font color=#FF0000> you have to ensure that any two different points in the same &quot;Hyperspace&quot; could be connected directly or indirectly by the connections you build in this &quot;Hyperspace&quot;. </font> </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input consists of several test cases.<br>In the first line there is an integer n (1&lt;=n&lt;=100), indicating the number of ¡°Hyperspaces¡±<br>Then follow an integer m (1&lt;=m&lt;=100000) <br>You can assume that the number of different points in every ¡°Hyperspace¡± is always no larger than 100.<br>The next m lines contain the descriptions of all the points<br>All the descriptions are given in the following format x,y,z,id<br>Indicating the point (x,y,z) belongs to the id ¡°Hyperspace¡±<br>id is an integer.<br>x,y,z are all real number with at most four fractional digits.<br>-10000&lt;=x,y,z&lt;=10000,1&lt;=id&lt;=n</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output the minimal cost on a single line.<br>Please round it to four fractional digits.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
2
1 2 1 1
1 3 1 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1.0000</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>AekdyCoin</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=HDU 1st ¡°Old-Vegetable-Birds Cup¡± Programming Open Contest&source=1&searchmode=source'> HDU 1st ¡°Old-Vegetable-Birds Cup¡± Programming Open Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2810'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2810'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2810">Discuss</a> | <a href='note/note.php?pid=2810'>Note</a><br></td></tr></div></body></html>