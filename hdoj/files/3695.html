<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3695</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Computer Virus on Planet Pandora</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 6000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 256000/128000 K (Java/Others)<br>Total Submission(s): 916&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 250<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content> &nbsp;&nbsp;&nbsp;&nbsp;Aliens on planet Pandora also write computer programs like us. Their programs only consist of capital letters (¡®A¡¯ to ¡®Z¡¯) which they learned from the Earth. On <br>planet Pandora, hackers make computer virus, so they also have anti-virus software. Of course they learned virus scanning algorithm from the Earth. Every virus has a pattern string which consists of only capital letters. If a virus¡¯s pattern string is a substring of a program, or the pattern string is a substring of the reverse of that program, they can say the program is infected by that virus. Give you a program and a list of virus pattern strings, please write a program to figure out how many viruses the program is infected by.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases. The first line in the input is an integer T ( T&lt;= 10) indicating the number of test cases.<br><br>For each test case:<br><br>The first line is a integer n( 0 &lt; n &lt;= 250) indicating the number of virus pattern strings.<br><br>Then n lines follows, each represents a virus pattern string. Every pattern string stands for a virus. It¡¯s guaranteed that those n pattern strings are all different so there <br>are n different viruses. The length of pattern string is no more than 1,000 and a pattern string at least consists of one letter.<br><br>The last line of a test case is the program. The program may be described in a compressed format. A compressed program consists of capital letters and <br>¡°compressors¡±. A ¡°compressor¡± is in the following format:<br><br>[qx]<br><br>q is a number( 0 &lt; q &lt;= 5,000,000)and x is a capital letter. It means q consecutive letter xs in the original uncompressed program. For example, [6K] means <br>¡®KKKKKK¡¯ in the original program. So, if a compressed program is like:<br><br>AB[2D]E[7K]G<br><br>It actually is ABDDEKKKKKKKG after decompressed to original format.<br><br>The length of the program is at least 1 and at most 5,100,000, no matter in the compressed format or after it is decompressed to original format.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print an integer K in a line meaning that the program is infected by K viruses.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
2
AB
DCB
DACB
3
ABC
CDE
GHI
ABCCDEFIHG
4
ABB
ACDEE
BBB
FEEE
A[2B]CD[4E]F</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">0
3
2
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>In the second case in the sample input, the reverse of the program is ¡®GHIFEDCCBA¡¯, and ¡®GHI¡¯ is a substring of the reverse, so the program is infected 
by virus ¡®GHI¡¯.
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Asia Fuzhou Regional Contest&source=1&searchmode=source'> 2010 Asia Fuzhou Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>chenyongfu</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3695'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3695'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3695">Discuss</a> | <a href='note/note.php?pid=3695'>Note</a><br></td></tr></div></body></html>