<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3324</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>The Beijing-Hangzhou Grand Canal</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 32&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 1<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The Beijing-Hangzhou Grand Canal is the longest artificial canal, in which many transportation companies run their boats. Each transportation company is responsible for transporting on one leg of the river. For the regulations  of the GBs, each company is only allowed to have the same type boats. <br><br>The sands of the river keep changing  the depth of the water. Boats will get stranded if the water depth is less than the waterline, so the GM often digs the riverbed to maintain watercourse to transport smoothly.<br><br>Mr April wants to send a gift to Ms April for her birthday via the canal. But he do not know whether the watercourse is smooth, he turns to intelligent you for help to tell him whether he can deliver the gift or not.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>In the first line ,there are 3 non-negative interger , S, H and X, S stands for the length of the river, H is the original depth of the water, and there are X transportation companies.<br><br>Then follow  X  lines, in  the (1+i)th line ,there are 3 numbers, a , b, and c, indicate Company i is responsible for the transportation between a and b, and c is the waterline of the boats from the company.<br><br>In (X+2)th line there is an interger Q , indicating there would be Q command lines. There are 4 variations of the command.<br><br>(1)F a b h  meaning  for sand silting, from a to b of the river the water depth has reduce to h meters,but those places where the depth is less than     h meters remain the same.<br><br>(2)D a b h indicating the GM is trying removing the sand silting and the water depth reaches h meters ,but those places where the depth is more than h meters keeps the same.<br><br>(3)O a b implying Mr April wants to know whether there is a possible ways to deliver the gift from a to b. In other words, he wants to find a way to cover the segment [a, b] or [b,a] by one or some company's available boats.<br><br>(4)C a h saying Company a has changed all its boats to new ones which has the waterline as h.<br><br>0&lt;S&lt;100000, 0&lt;=x&lt;=100,0&lt;=H &lt;=1000, 0&lt;=Q&lt;=1000</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each asking from Mr April ,responds ¡°Yes¡± if it¡¯s possible to deliver the gift, ¡°No¡± if not.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">10 2 2
1 6 4
5 8 2
8
O 5 7
O 3 7
D 3 5 4
O 3 7
F 6 7 1
O 3 7
C 2 1
O 3 7
4 3 2
1 2 1
3 4 2
1
O 2 3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Yes
No
Yes
No
Yes
Yes</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>AprilStar</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=HDU ¡°Valentines Day¡± Open Programming Contest 2010-02-14 &source=1&searchmode=source'> HDU ¡°Valentines Day¡± Open Programming Contest 2010-02-14  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>wxl</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3324'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3324'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3324">Discuss</a> | <a href='note/note.php?pid=3324'>Note</a><br></td></tr></div></body></html>