<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2475</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Box</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/5000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 859&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 279<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>There are N boxes on the ground, which are labeled by numbers from 1 to N. The boxes are magical, the size of each one can be enlarged or reduced arbitrarily.<br>Jack can perform the ¡°MOVE x y¡± operation to the boxes: take out box x; if y = 0, put it on the ground; Otherwise, put it inside box y. All the boxes inside box x remain the same. It is possible that an operation is illegal, that is, if box y is contained (directly or indirectly) by box x, or if y is equal to x.<br>In the following picture, box 2 and 4 are directly inside box 6, box 3 is directly inside box 4, box 5 is directly inside box 1, box 1 and 6 are on the ground.<br><img src=../../data/images/C165-1002-1.jpg><br>The picture below shows the state after Jack performs ¡°MOVE 4 1¡±:<br><img src=../../data/images/C165-1002-2.jpg><br>Then he performs ¡°MOVE 3 0¡±, the state becomes:<br><img src=../../data/images/C165-1002-3.jpg><br>During a sequence of MOVE operations, Jack wants to know the root box of a specified box. The root box of box x is defined as the most outside box which contains box x. In the last picture, the root box of box 5 is box 1, and box 3¡¯s root box is itself.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Input contains several test cases.<br>For each test case, the first line has an integer N (1 &lt;= N &lt;= 50000), representing the number of boxes.<br>Next line has N integers: a1, a2, a3, ... , aN (0 &lt;= ai &lt;= N), describing the initial state of the boxes. If ai is 0, box i is on the ground, it is not contained by any box; Otherwise, box i is directly inside box ai. It is guaranteed that the input state is always correct (No loop exists).<br>Next line has an integer M (1 &lt;= M &lt;= 100000), representing the number of MOVE operations and queries.<br>On the next M lines, each line contains a MOVE operation or a query:<br>1.&nbsp;&nbsp;MOVE x y, 1 &lt;= x &lt;= N, 0 &lt;= y &lt;= N, which is described above. If an operation is illegal, just ignore it.<br>2.&nbsp;&nbsp;QUERY x, 1 &lt;= x &lt;= N, output the root box of box x.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each query, output the result on a single line. Use a blank line to separate each test case.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
0 1
5
QUERY 1
QUERY 2
MOVE 2 0
MOVE 1 2
QUERY 1
6
0 6 4 6 1 0
4
MOVE 4 1
QUERY 3
MOVE 1 4
QUERY 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
1
2

1
1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 Asia Regional Chengdu&source=1&searchmode=source'> 2008 Asia Regional Chengdu </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2475'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2475'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2475">Discuss</a> | <a href='note/note.php?pid=2475'>Note</a><br></td></tr></div></body></html>