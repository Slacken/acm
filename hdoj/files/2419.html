<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2419</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Boring Game</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 433&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 80<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Brian's little sister Mary is fond of strange games involving lots of calculation. Unfortunately she's not so good at mathematics so Brian's often asked to calculate the values needed for her. Recently Brian's facing another such problem:<br>An undirected graph with N vertexes and M edges is first drawn by Mary. Then, Mary randomly assigns an integer value to each of the vertexes. After that, Mary will perform a sequence of operations on the graph, each operation being of one of the following type:<br>&nbsp;&nbsp;&nbsp;&nbsp;a)&nbsp;&nbsp;Among all vertexes connecting with vertex X via some edges, find the least value that is no less than value K. If such value cannot be found, zero will be returned instead.<br>&nbsp;&nbsp;&nbsp;&nbsp;b)&nbsp;&nbsp;Updates the value assigned to vertex X to K.<br>&nbsp;&nbsp;&nbsp;&nbsp;c)&nbsp;&nbsp;Erases an edge connecting vertex A and B from the graph.<br>Mary¡¯s interested in the average value of all answers to type a) operations. Would you please help Brian to finish this boring task? <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases in the input file. Each case starts with three integers, N, M, and Q (1 &lt;= N &lt;= 2 * 10<sup>4</sup>, 0 &lt;= M &lt;= 6 * 10<sup>4</sup>, 1 &lt;= Q &lt;= 3 * 10<sup>5</sup>). The next N lines describe the initial value assigned to each vertex. The next part of each test case consists of M lines, and describes the edges in the graph at the beginning. Vertexes are numbered from 1 to N. The last part of each test case describes the operations to be performed on the tree. For operations of a) type, a line similar to ¡°F X K¡± will be given; for operations of b) type, a line with the format of ¡°U X K¡± will be given; and for c) type, the description will be given in the format similar to ¡°E A B¡±. You can assume that there will always be at least one a) type query. The absolute value assigned to any vertex at any time will not exceed 10000.<br>There is a blank line between two successive cases. Input ends with End-of-File. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output one real number ¨C the requested value with precision up to 0.001, in the format as indicated in the sample output. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 3 8
4
5
8
1 2
2 3
1 3
F 1 4 
E 1 3
F 2 7
E 2 3
E 1 2
F 2 7
U 3 6
F 3 3

1 0 1
0
F 1 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 4.500
Case 2: 0.000

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
For case 1, the answers for the queries are 4, 8, 0 and 6 respectively.
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 Asia Hangzhou Regional Contest Online&source=1&searchmode=source'> 2008 Asia Hangzhou Regional Contest Online </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2419'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2419'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2419">Discuss</a> | <a href='note/note.php?pid=2419'>Note</a><br></td></tr></div></body></html>