<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 1837</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Breweries</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 15000/15000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65535/65535 K (Java/Others)<br>Total Submission(s): 128&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 12<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>People drink a lot of beer in Romania. For each city i of the N cities of the country (numbered from 1 to N), the amount of beer B<sub>i</sub> demanded by its inhabitants is known. In order to satisfy the overall demand, a famous beer company wishes to build K breweries in K distinct cities of Romania. From these breweries, beer will be transported to other cities using the existing road network. Each road connects two distinct cities and has a certain length. Because of the recent floods, the road network of Romania has the shape of a tree: that is, there is exactly one path between any pair of cities. Let¡¯s condier a city i and a brewery located in a city X, which is the closest brewery to i. The cost of transporting beer to the city i is dist(i,X)*B<sub>i</sub>, where dist(i,X) is the distance between city i and city X. The beer company wants to choose the locations of the K breweries in such a way that the maximum cost of transporting beer to any city in the country is minimized.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of input contains an integer number T, representing the number of test cases to follow. The first line of each test case contains 2 integer numbers: N (1&lt;=N&lt;=100.000) and K (1&lt;=K&lt;=N). The next N lines contain the beer demands of each city: the i<sup>th</sup> of these lines contains the value B<sub>i</sub> (1&lt;=B<sub>i</sub>&lt;=10.000). The next N-1 lines contain 3 integers each: A, B and L (1&lt;=L&lt;=10.000), meaning that there exists a road of length L between city A and city B.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each of the T test cases, in the order given in the input, print one line containing the minimum value for the maximum cost of transporting beer, in the case of an optimal placement of the breweries.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
4 2
3
4
2
7
1 2 10
2 3 21
2 4 57</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">42
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
Explanation for sample input and output:
The tree is presented in the figure below. The cities where the breweries were built are colored in yellow (the darker color). 
The cost of beer transportation equal to 42 is achieved between city 3 and the brewery located in city 2.
<center><img src='../../../data/images/C92-1002-1.jpg'></center>

</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>Mugurel Ionut Andreica</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=Politehnica University of Bucharest Local Team Contest 2007&source=1&searchmode=source'> Politehnica University of Bucharest Local Team Contest 2007 </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=1837'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=1837'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=1837">Discuss</a> | <a href='note/note.php?pid=1837'>Note</a><br></td></tr></div></body></html>