<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3246</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Special Flow</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 22&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 4<br><font color=red>Special Judge</font></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>There are n junctions numbered from 1 to n, connected by <b>undirected</b> pipes, in which water can flow through. Junction 1 is the source, junction n is the sink. Pipes have capacities, restricting the maximal velocity that water can move through. There will be no water leak, so for every junction (except the source and sink), the amount of water flowing into the junction is equal to the amount of water flowing out of it.<br>Your task is to find the maximal volume of water that can flow from junction 1 to junction n, during one unit time. Isn¡¯t it the traditional max-flow problem? Well, not exactly. There is an additional restriction in this problem: for an arbitrary pair of junctions u and v, there is a constant S(u,v) such that, in <b>every</b> path from u and v, the <b>sum of water velocity</b> on the arcs along the path is always S(u,v). We calculate the sum in a way such that if the water flows against direction of the path from u to v, its velocity is negated. Note that, for two different pairs (u1,v1) and (u2,v2), S(u,v) may be different from S(u2,v2).<br><center><img src=../../../data/images/3246-1.jpg></center><br>The picture above shows an example pipe network. Capacities of the pipes are shown in the left, while the actual water velocity and flowing directions are shown in the right. You can examine, for example, S(2,4) = 2.8, S(3,1)=-2, S(1,4)=4.4.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There will be at most 30 test cases. Each case begins with two integers n and m (2 &lt;= n &lt;= 100, 1 &lt;= m &lt;= 5000), the number of junctions and pipes. The next m lines contain the description of pipes. Each pipe is represented by three integers a, b and c, where a and b are the numbers of two <b>different</b> junctions connected by the pipe, and c is the maximal possible water velocity in that pipe (0 &lt;= c &lt;= 10000). The input ends with n = m = 0. There can be multiple pipes between a given pair of junctions.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the maximum volume as a floating point number (in any format you like). This number should match the exact result with the maximal absolute difference of 0.0001.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4 6
1 3 2
1 2 3
1 2 2
2 4 5
2 3 2
3 4 5
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5.2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 ¡°NIT Cup¡± National Invitational Contest&source=1&searchmode=source'> 2009 ¡°NIT Cup¡± National Invitational Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>wujianhua</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3246'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3246'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3246">Discuss</a> | <a href='note/note.php?pid=3246'>Note</a><br></td></tr></div></body></html>