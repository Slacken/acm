<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3879</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Base Station</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65768/32768 K (Java/Others)<br>Total Submission(s): 964&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 396<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>A famous mobile communication company is planning to build a new set of base stations. According to the previous investigation, n places are chosen as the possible new locations to build those new stations. However, the condition of each position varies much, so the costs to built a station at different places are different. The cost to build a new station at the ith place is P<sub>i</sub> (1&lt;=i&lt;=n).<br><br>When complete building, two places which both have stations can communicate with each other.<br><br>Besides, according to the marketing department, the company has received m requirements. The ith requirement is represented by three integers A<sub>i</sub>, B<sub>i</sub> and C<sub>i</sub>, which means if place A<sub>i </sub>and B<sub>i</sub> can communicate with each other, the company will get C<sub>i</sub> profit.<br><br>Now, the company wants to maximize the profits, so maybe just part of the possible locations will be chosen to build new stations. The boss wants to know the maximum profits.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Multiple test cases (no more than 20), for each test case:<br>The first line has two integers n (0&lt;n&lt;=5000) and m (0&lt;m&lt;=50000).<br>The second line has n integers, P1 through Pn, describes the cost of each location.<br>Next m line, each line contains three integers, A<sub>i</sub>, B<sub>i</sub> and C<sub>i</sub>, describes the ith requirement.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>One integer each case, the maximum profit of the company.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5 5
1 2 3 4 5
1 2 3
2 3 4
1 3 3
1 4 2
4 5 3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>liulibo</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 5 - Host by BNU&source=1&searchmode=source'> 2011 Multi-University Training Contest 5 - Host by BNU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3879'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3879'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3879">Discuss</a> | <a href='note/note.php?pid=3879'>Note</a><br></td></tr></div></body></html>