<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3865</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>A Hard Journey</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 191&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 84<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>ChenX was taken away by the arch devil, so the sharp shooter Brother Zheng was going to rescue him. The enemy¡¯s army was distributed in an N * N grid, and each grid also can be divided in M * M small grids.<br><br>Brother Zheng's army has two kinds of attack form : from top to bottom, or from left to right. The weapon they use is Break-Cloud arrow, so each arrow will cost P fighting strength to eliminate a row or a column enemies in a big grid.<br><br>Notice that they can change the attack form at any time, and when they once change their attack form, they will use Q fighting strength.<br><br>The initial position of Brother Zheng is at the top-left corner, and ChenX was locked by arch devil at the right-bottom corner. When once make a move, Brother Zheng should eliminate all the enemies in the current big grid. If the current attack form is from top to bottom, then they can move onto the right grid of the big grid; if the current attack form is from left to right, then they can move onto the bottom grid of the big grid. The initial attack form can be either of the two.<br><br>Now Brother Zheng want to know how much the least fighting strength is so that can rescue ChenX.<br><br>For the case as the followed picture, N = 2, M = 3, P = 2, Q = 1.<br>Brother Zheng choices to start with the attack form: from top to bottom. It takes P * 1 fighting strength to eliminate all the enemies at grid[1][1]. Then Brother Zheng changed attack form to ¡°from left to right¡± using Q fighting strength, and moved to the bottom grid[2][1]. To eliminate all the enemies, it takes P * 2 fighting strength. Then Brother Zheng changed attack form to ¡±from top to bottom¡± using Q fighting strength, and moved to the right grid[2][2], after used P * 3 fighting strength to eliminate this grid, ChenX was rescue with P * 1 + Q + P * 2 + Q + P * 3 = 14 fighting strength.<br><center><img src=../../data/images/C352-1007-1.jpg></center></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>For each case, the first line contains 4 integers: N, M, P, Q(0 &lt; N &lt;= 20, 0 &lt; M &lt;= 15, 0 &lt;= P &lt;= 20, 0 &lt;= Q &lt;= 20), the next N * N blocks, each block contains M * M matrixes, rows first.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, output one integer which indicates the least fighting strength.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 3 2 1
0 0 1
0 0 1
0 0 1
1 1 1
1 1 1
1 1 1
0 1 1
0 0 0
1 1 1
1 0 0
0 1 0
0 0 1
1 3 3 1
0 0 1
0 0 1
1 1 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">14
7</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 3 - Host by BIT&source=1&searchmode=source'> 2011 Multi-University Training Contest 3 - Host by BIT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3865'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3865'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3865">Discuss</a> | <a href='note/note.php?pid=3865'>Note</a><br></td></tr></div></body></html>