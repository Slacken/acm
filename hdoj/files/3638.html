<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3638</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Go , SuSu</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 221&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 49<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>When SuSu and his friends visited GanQuan village , something dangerous happened on them . They were trapped in a mysterious cave , what was worse ,there was a terrible monster lived in the cave , so they had to escape from the cave as quickly as possible . <br><center><img src=../../../data/images/C308-1007-1.jpg></center><br>But little monsters were also in the cave, as a result ,when SuSu was seen  by the little monsters ,they would notice their boss to catch SuSu back.<br>Little monsters' visual field is showed in figure A. The grid colored red represents where the monster stands, the arrow represents which direction the monster walk to ,and the grids colored blue and red represents where the very monster can see at this moment. The monsters often walks in a straight line, and when they faces a wall or the boundary of the maze in front of him, they will cost 1 seconds to turn back, and then walk back along the straight line, until reach a wall again. <br>If SuSu was seen by the monsters ,it's impossible for them to escape from the cave . SuSu needs your help , please tell him the minimum time he needs to walk from the start point to the exit of the cave , be careful not to be seen by the monsters. Every seconds SuSu can move upward downward leftward and rightward , and can also make no movement.<br><center><img src=../../../data/images/C308-1007-2.jpg></center> <br><center>Figure A</center></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of input gives the number of cases, T (at most 90).<br>the first line of each case has four numbers n,m. (2&lt;=n,m&lt;=50)<br>then n lines with m characters describe the maze<br>'A' represents the init position of SuSu.<br>'B' represents the exit position of the cave.<br>'.' represents the grids can be walked on.<br>'*' represents the wall which can not be stepped on.<br>Then follows a number  k (at most 50).<br>&nbsp;&nbsp;Next k lines with three integers x , y , d (1 &lt;= x &lt;= n,1 &lt;= y &lt;= m,1 &lt;= d &lt;= 4).represents a monster walking to d direction is in (x,y) positon (the top-left grid is (1,1) ) at 0 seconds . <br>&nbsp;&nbsp;The monster walks up when d == 1. walk down when d == 2.walk left when d == 3.walk right when d == 4.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>If SuSu can get to the exit in 1000 seconds ,output the minimum time he need. print &quot;胜败兵家事不期 卷土重来是大侠&quot; otherwise.<br>Following the case number (start with 1). </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
3 4
*.*.
.A.B
***.
1
3 4 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>ReDow</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest（19）――Host by HDU&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest（19）――Host by HDU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3638'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3638'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3638">Discuss</a> | <a href='note/note.php?pid=3638'>Note</a><br></td></tr></div></body></html>