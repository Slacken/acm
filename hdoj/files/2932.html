<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2932</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Extraordinarily Tired Students</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 50&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 27<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>When a student is too tired, he can't help sleeping in class, even if his favorite teacher is right here in front of him. Imagine you have a class of extraordinarily tired students, how long do you have to wait, before all the students are listening to you and won't sleep any more? In order to complete this task, you need to understand how students behave. When a student is awaken, he struggles for a minutes listening to the teacher (after all, it's too bad to sleep all the time). After that, he counts the number of awaken and sleeping students (including himself). If there are strictly more sleeping students than awaken students, he sleeps for b minutes. Otherwise, he struggles for another a minutes, because he knew that when there is only very few sleeping students, there is a big chance for them to be punished! Note that a student counts the number of sleeping students only when he wants to sleep again. Now that you understand each student could be described by two integers a and b, the length of awaken and sleeping period. If there are always more sleeping students, these two periods continue again and again. We combine an awaken period with a sleeping period after it, and call the combined period an awaken-sleeping period. For example, a student with a=1 and b=4 has an awaken-sleeping period of awaken-sleeping-sleeping-sleeping-sleeping. In this problem, we<br>need another parameter c (1 ¡Ü c ¡Ü a+b) to describe a student's initial condition: the initial position in his awaken-sleeping period. The 1st and 2nd position of the period discussed above are awaken and sleeping, respectively.<br>Now we use a triple (a, b, c) to describe a student. Suppose there are three students (2, 4, 1), (1, 5, 2) and (1, 4, 3), all the students will be awaken at time 18. The details are shown in the table below.<br><br><center><img src=../../../data/images/C193-1004-1.JPG></center><br><br>Write a program to calculate the first time when all the students are not sleeping.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input consists of several test cases. The first line of each case contains a single integer n (1 ¡Ü n ¡Ü 10), the number of students. This is followed by n lines, each describing a student. Each of these lines contains three integers a, b, c (1 ¡Ü a, b ¡Ü 5), described above. The last test case is followed by a single zero, which should not be processed.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the case number and the first time all the students are awaken. If it'll never happen, output -1.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
2 4 1
1 5 2
1 4 3
3
1 2 1
1 2 2
1 2 3
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 18
Case 2: -1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2006 Asia Regional Xi-An&source=1&searchmode=source'> 2006 Asia Regional Xi-An </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2932'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2932'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2932">Discuss</a> | <a href='note/note.php?pid=2932'>Note</a><br></td></tr></div></body></html>