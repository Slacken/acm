<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2426</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Interesting Housing Problem</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 1348&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 497<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>For any school, it is hard to find a feasible accommodation plan with every student assigned to a suitable apartment while keeping everyone happy, let alone an optimal one. Recently the president of University ABC, Peterson, is facing a similar problem. While Peterson does not like the idea of delegating the task directly to the class advisors as so many other schools are doing, he still wants to design a creative plan such that no student is assigned to a room he/she dislikes, and the overall quality of the plan should be maximized. Nevertheless, Peterson does not know how this task could be accomplished, so he asks you to solve this so-called &quot;interesting&quot; problem for him.<br>Suppose that there are N students and M rooms. Each student is asked to rate some rooms (not necessarily all M rooms) by stating how he/she likes the room. The rating can be represented as an integer, positive value meaning that the student consider the room to be of good quality, zero indicating neutral, or negative implying that the student does not like living in the room. Note that you can never assign a student to a room which he/she has not rated, as the absence of rating indicates that the student cannot live in the room for other reasons.<br>With limited information available, you've decided to simply find an assignment such that every student is assigned to a room he/she has rated, no two students are assigned to the same room, and the sum of rating is maximized while satisfying Peterson's requirement. The question is бн what exactly is the answer?<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases in the input file. Each test case begins with three integers, N, M, and E (1 &lt;= N &lt;= 500, 0 &lt;= M &lt;= 500, 0 &lt;= E &lt;= min(N * M, 50000)), followed by E lines, each line containing three numbers, S<sub>i</sub>, R<sub>i</sub>, V<sub>i</sub>, (0 &lt;= S<sub>i</sub> &lt; N, 0 &lt;= R<sub>i</sub> &lt; M, |V<sub>i</sub>| &lt;= 10000), describing the rating V<sub>i</sub> given by student S<sub>i</sub> for room R<sub>i</sub>. It is guaranteed that each student will rate each room at most once.<br>Each case is followed by one blank line. Input ends with End-of-File.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, please output one integer, the requested value, on a single line, or -1 if no solution could be found. Use the format as indicated in the sample output.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 5 5
0 1 5
0 2 7
1 1 6
1 2 3
2 4 5

1 1 1
0 0 0

1 1 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 18
Case 2: 0
Case 3: -1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 Asia Hangzhou Regional Contest Online&source=1&searchmode=source'> 2008 Asia Hangzhou Regional Contest Online </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2426'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2426'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2426">Discuss</a> | <a href='note/note.php?pid=2426'>Note</a><br></td></tr></div></body></html>