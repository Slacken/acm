<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2695</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Molecular Weight Calculator </h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 60000/20000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 87&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 19<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Even though not good at memorizing, Alex is fond of Chemistry. When solving problems, he always needs to calculate the  <br>molecular weight and quantity of each kind of elements. Lazy Alex hates that and turns to you for help. <br><br>Your task is: <br>Given a chemical formula, calculate its molecular weight and quantity of each kind of elements. <br><br>The atom is represented by either a single capital letter or a capital letter and a lower case letter. E.g. C, Ca, H, O. Formulas  <br>may contain brackets: '(',')', which is always followed by the quantity of that atomic mission. The number after an atom or a  <br>bracket represents the quantity of that atomic mission. E.g. CH4, CaCO3, Fe(SCN)3. Brackets may be nested. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input consists of multiple test cases. The first line of input contains an integer T, which is the number of test cases. <br><br>Each test case is on several lines. The first line contains an integer, N, indicating the quantity of known elements. <br>Each of the following n lines is consisting of a element description, start with a element name and followed by the weight  <br>W (floating point number), separated by a space. <br>The (n+1)-th line consists an integer M, indicating the quantity of formulas. <br>Each of the following M lines is consisting of a formula. <br><br>[Technical Specification] <br>1.T is an integer, and T &lt;=10.  <br>2.N is an integer, and 1 &lt;= N &lt;= 200. <br>3.W is a floating point number with two fractional digits, and 1 &lt;= W &lt;= 400. <br>4.M is an integer, and 1 &lt;= M &lt;= 100. <br>5.Numbers in the formula is always in the range of [2,9] inclusive. <br>6.The formula?s length does not exceed 500. <br>7.There's no blank line between two test cases. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each formula in each test case, print a single line as the format below. <br>Format: <br>Weight Element[quantity] Element[quantity] Element[quantity] ... <br>e.g. 44.00 C[1] O[2] <br>The element is ordered as they were in the input. Display all the elements except for those not in the formula. The weight is  <br>rounded to two fractional digits. Notice that the answer may be very large. <br>There's no whitespace at the end of each line. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1 
7 
H 1.00 
C 12.00 
O 16.00 
N 14.00 
S 32.00 
Ca 40.00 
Fe 56.00 
4 
CO2 
CH4 
CaCO3 
Fe(SCN)3 </div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">44.00 C[1] O[2] 
16.00 H[4] C[1] 
100.00 C[1] O[3] Ca[1] 
230.00 C[3] N[3] S[3] Fe[1] </div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=The 4th Baidu Cup Central China Invitational Programming Contest&source=1&searchmode=source'> The 4th Baidu Cup Central China Invitational Programming Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>yifenfei</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2695'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2695'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2695">Discuss</a> | <a href='note/note.php?pid=2695'>Note</a><br></td></tr></div></body></html>