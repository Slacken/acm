<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 4114</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Disney's FastPass</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 20000/10000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 455&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 106<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content><i><br>Disney's FastPass is a virtual queuing system created by the Walt Disney Company. First introduced in 1999 (thugh the idea of a ride reservation system was first introduced in world fairs), Fast-Pass allows guests to avoid long lines at the attractions on which the system is installed, freeing them to enjoy other attractions during their wait. The service is available at no additional charge to all park guests.<br>--- wikipedia<br></i><br><br><center><img src=../../data/images/4114-1.jpg></center> <br>Disneyland is a large theme park with plenties of entertainment facilities, also with a large number of tourists. Normally, you need to wait for a long time before geting the chance to enjoy any of the attractions. The FastPass is a system allowing you to pick up FastPass-tickets in some specific position, and use them at the corresponding facility to avoid long lines. With the help of the FastPass System, one can arrange his/her trip more efficiently.<br>You are given the map of the whole park, and there are some attractions that you are interested in. How to visit all the interested attractions within the shortest time? </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line contains an integer T(1&lt;=T&lt;=25), indicating the number of test cases.<br>Each test case contains several lines.<br>The first line contains three integers N,M,K(1 &lt;= N &lt;= 50; 0 &lt;= M &lt;= N(N - 1)/2; 0 &lt;= K &lt;= 8), indicating the number of locations(starting with 1, and 1 is the only gate of the park where the trip must be started and ended), the number of roads and the number of interested attractions.<br>The following M lines each contains three integers A,B,D(1 &lt;= A,B &lt;= N; 0 &lt;= D &lt;= 10^4) which means it takes D minutes to travel between location A and location B.<br>The following K lines each contains several integers P<sub>i</sub>, T<sub>i</sub>, FT<sub>i</sub>,N<sub>i</sub>, F<sub>i,1</sub>, F<sub>i,2</sub> ... F<sub>i,Ni-1</sub>, F<sub>iNi</sub> ,(1 &lt;= P<sub>i</sub>,N<sub>i</sub>, F<sub>i,j</sub> &lt;=N, 0 &lt;= FT<sub>i</sub> &lt;= T<sub>i</sub> &lt;= 10^4), which means the ith interested aªÝraction is placed at location Pi and there are Ni locations F<sub>i,1</sub>; F<sub>i,2</sub> ... F<sub>i</sub>,N<sub>i</sub> where you can get the FastPass for the ith attraction. If you come to the ith attraction with its FastPass, you need to wait for only FTi minutes, otherwise you need to wait for Ti minutes.<br>You can assume that all the locations are connected and there is at most one road between any two locations.<br>Note that there might be several attrractions at one location.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case in the input, print one line: &quot;Case #X: Y&quot;, where X is the test case number (starting with 1) and Y is the minimum time of the trip.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
4 5 2
1 2 8
2 3 4
3 4 19
4 1 6
2 4 7
2 25 18 1 3
4 12 6 1 3
4 6 2
1 2 5
1 4 4
3 1 1
3 2 1
3 4 1
2 4 10
2 8 3 1 4
4 8 3 1 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case #1: 53
Case #2: 14</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Asia ChengDu Regional Contest&source=1&searchmode=source'> 2011 Asia ChengDu Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4114'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4114'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4114">Discuss</a> | <a href='note/note.php?pid=4114'>Note</a><br></td></tr></div></body></html>