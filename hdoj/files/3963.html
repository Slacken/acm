<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3963</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Sisters</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/65536 K (Java/Others)<br>Total Submission(s): 27&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 12<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Mikoto(Railgun) is an excellent ESP(Extra Sensory Perception) girl with the dreadful skill Railgun in Academy City. <br><center><img src=../../data/images/3963-1.jpg></center> <br>But there is a bitter reality that Mikoto's sisters are being massacred by Yuriko(Accelerator) for experiments. <br><center><img src=../../data/images/3963-2.jpg></center> <br>As Yuriko is the most powerful ESPer, what Mikoto can do is to destroy all related laboratories in Academy City to delay the massacre.<br><br>N Laboratories are connected by M wires and the power system can be considered to an undirected graph.<br><br>Academy City is divided into several districts.<br><br>If there are at least two non-intersecting paths between two laboratories, then the two cities belong to the same district.<br><br>Two paths are considered as non-intersecting paths if and only if there is no same edge in both of them.<br><br>If there are one wire connecting two laboratories of two different districts, then the two districts are neighbors. Power can be transported between neighbor districts.<br><br>Mikoto can destroy all laboratories in the district where she is by the Railgun, that costs K+X(X is the numbers of laboratories in this district) points energy. Mikoto can use the Railgun anywhere and any number of times.<br><br>What's more, Mikoto generates electricity at the same time she shoot the Railgun. Mikoto can use the power to destroy all laboratories in other districts via wires. For any district to be attacked by electricity, the cost is f(n) points energy, and n is the number of districts (excluding the district where Mikoto shoot the Railgun) in the path from Mikoto to it. More specifically, if Mikoto have shot the Railgun destroying all laboratories in the district she chose, she can choose several other districts to be attacked by electricity she generate and the cost for each district is described above.<br><br>Now, the problem is the mininum cost to destroy all laboratories. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several test cases.<br><br>For each test case, the first line contains three integers, N(1 ¡Ü N ¡Ü 1000), M(1 ¡Ü M ¡Ü 1000000), K(1 ¡Ü K ¡Ü 1000000000).<br>Then, 2 to M + 1 lines, each line contain two different integers a and b (1 ¡Ü a,b ¡Ü N), meaning that there is a undirected wire between laboratories a and b.<br><br>Then, the M + 2 lines contain N-1 number, meaning f(1), f(2), ... , f(n - 1). (0 ¡Ü f(1) ¡Ü f(2) ¡Ü ... ¡Ü f(N - 1) ¡Ü 1000000000)<br><br>You can safely assume that all numbers in the input and output will in the range of 32-bit signed integer and all the laboratories are connected by wires.<br><br>Input is terminated by EOF. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output one single number which is the mininum cost to destroy all laboratories. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5 5 10
1 2
1 3
2 3
1 4
2 5
5 10 15 20
5 4 10
2 1
3 2
4 1
5 3
4 9 11 12</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">23
34</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 13 - Host by HIT &source=1&searchmode=source'> 2011 Multi-University Training Contest 13 - Host by HIT  </a> </div> <div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3963'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3963'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3963">Discuss</a> | <a href='note/note.php?pid=3963'>Note</a><br></td></tr></div></body></html>