<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3869</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Color the Simple Cycle</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65768/32768 K (Java/Others)<br>Total Submission(s): 106&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 36<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Consider a simple cycle with N vertices numbered from 1 to N. Each vertex and Each edge has an integer value. We use v[k] to represent the kth vertex's value, and e[k] to represent the kth edge's value. The kth edge is the edge of the kth and the (k+1)th vertex (the (N+m)th vertex is the mth vertex). Now we will use C different colors to color the graph. Every vertice will be colored by one of the C colors. If there exists some integer number k which satisfies v[i]=v[i+k] and e[i]=e[i+k] for each i from 1 to N(v[N+t]=v[t] and e[N+t]=e[t]), we call the graph is the same under k rotation.<br>If two ways of coloring the cycle can be the same with some rotation and under that rotation the color of the corresponding vertices are also the same, we consider the two ways are the same ways. Given the simple cycle and the number of colors we will use, how many different ways to color the cycle?<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>First comes an integer T representing the number of test cases. Each case consists of three lines. First line contains N(1&lt;=N&lt;=100000)  and C (1&lt;=C&lt;=1000000). Second line contains N integer numbers representing the vertex's values. The last line of each case contains N integer numbers representing the edge values. Each value is between 1 and 1000000.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, print a line with the different ways of coloring the cycle mod 1000000007.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 
3 1 
1 1 1 
2 2 2 
3 2 
1 1 1 
2 2 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 4 - Host by SDU&source=1&searchmode=source'> 2011 Multi-University Training Contest 4 - Host by SDU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3869'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3869'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3869">Discuss</a> | <a href='note/note.php?pid=3869'>Note</a><br></td></tr></div></body></html>