<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2934</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Gargoyle</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 179&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 22<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Gargoyles can trace their history back many thousands of years to ancient Egypt, Greece, and Rome. Terra cotta waterspouts were formed in the shapes of animals such as lions and birds to serve the physical function of running the<br>rainwater away from the walls and foundations of buildings, and the spiritual function of protecting from evil forces.<br>Have you ever dreamed of creating your own castle with a lot of beautiful gargoyles on the walls? To your knowledge,<br>the speed of water coming out of each gargoyle should be identical, so an elaborately designed water system is required.<br>The water system consists of a huge reservoir and several interconnecting water pipes. Pipes cannot save water, so the total incoming and outgoing speed of water should be equal at each connection.<br>All the water from gargoyles flows into the reservoir, which is located at the bottom of the castle. Some pipes are connecting the reservoir, but water can only go from the reservoir to pipes, but never from pipes back to the reservoir. A micro-processor is installed inside each pipe, so the speed of water could easily be controlled. However, the microprocessors consume electricity. The exact cost in each pipe is proportional to the speed of water. If the cost constant in the i-th pipe is ci, the electricity cost in that pipe is civi, where vi is the speed of water in that pipe. Write a program to find the optimal configuration of the water system (i.e. the water speed in each pipe) of your dream castle, so that the total cost is minimized. It is always possible to build a water system.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input consists of several test cases. The first line of each case contains three integers n, m and k (1 ¡Ü n ¡Ü 25, 1 ¡Ü m ¡Ü 50, 1 ¡Ü k ¡Ü 1000), the number of gargoyles, the number of pipe connections and the number of pipes. The following k lines each contains five integers a, b, l, u, c (0 ¡Ü a, b ¡Ü n + m, 0 ¡Ü l ¡Ü u ¡Ü 100, 1 ¡Ü c ¡Ü 100), describing each pipe. a and b<br>are the incoming and outgoing vertex number (reservoir is 0, gargoyles are numbered 1 to n, pipe connections are numbered n + 1 to n + m), lower-bound and upper-bound of water speed, and the cost constant. No pipe connects two identical vertices. For every pipe, the incoming vertex will never be a gargoyle, and the outgoing vertex will never be the reservoir. For every pair of vertices, there could be at most one pipe connecting them (if a pipe is going from a to b, no pipes can go from a to b, or from b to a). The last test case is followed by a single zero, which should not be processed.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the case number and minimal cost to two decimal places.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 1 4
0 4 8 15 5
4 1 2 5 2
4 2 1 6 1
4 3 3 7 2
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 60.00</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2006 Asia Regional Xi-An&source=1&searchmode=source'> 2006 Asia Regional Xi-An </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2934'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2934'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2934">Discuss</a> | <a href='note/note.php?pid=2934'>Note</a><br></td></tr></div></body></html>