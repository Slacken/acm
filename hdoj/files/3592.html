<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3592</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>World Exhibition</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 680&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 316<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Nowadays, many people want to go to Shanghai to visit the World Exhibition. So there are always a lot of people who are standing along a straight line waiting for entering. Assume that there are N (2 &lt;= N &lt;= 1,000) people numbered 1..N who are standing in the same order as they are numbered. It is possible that two or more person line up at exactly the same location in the condition that those visit it in a group.<br><br>There is something interesting. Some like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of X (1 &lt;= X &lt;= 10,000) constraints describes which person like each other and the maximum distance by which they may be separated; a subsequent list of Y constraints (1 &lt;= Y &lt;= 10,000) tells which person dislike each other and the minimum distance by which they must be separated.<br><br>Your job is to compute, if possible, the maximum possible distance between person 1 and person N that satisfies the distance constraints.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>First line: An integer T represents the case of test.<br><br>The next line: Three space-separated integers: N, X, and Y. <br><br>The next X lines: Each line contains three space-separated positive integers: A, B, and C, with 1 &lt;= A &lt; B &lt;= N. Person A and B must be at most C (1 &lt;= C &lt;= 1,000,000) apart.<br><br>The next Y lines: Each line contains three space-separated positive integers: A, B, and C, with 1 &lt;= A &lt; B &lt;= C. Person A and B must be at least C (1 &lt;= C &lt;= 1,000,000) apart.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each line: A single integer. If no line-up is possible, output -1. If person 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between person 1 and N.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
4 2 1
1 3 8
2 4 15
2 3 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">19</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>alpc20</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨15£©¡ª¡ªHost by NUDT&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨15£©¡ª¡ªHost by NUDT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhouzeyong</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3592'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3592'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3592">Discuss</a> | <a href='note/note.php?pid=3592'>Note</a><br></td></tr></div></body></html>