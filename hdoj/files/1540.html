<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 1540</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Tunnel Warfare</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 4000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 1970&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 727<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>During the War of Resistance Against Japan, tunnel warfare was carried out extensively in the vast areas of north China Plain. Generally speaking, villages connected by tunnels lay in a line. Except the two at the ends, every village was directly connected with two neighboring ones.<br><br>Frequently the invaders launched attack on some of the villages and destroyed the parts of tunnels in them. The Eighth Route Army commanders requested the latest connection state of the tunnels and villages. If some villages are severely isolated, restoration of connection must be done immediately!<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of the input contains two positive integers n and m (n, m ¡Ü 50,000) indicating the number of villages and events. Each of the next m lines describes an event.<br><br>There are three different events described in different format shown below:<br><br>D x: The x-th village was destroyed.<br><br>Q x: The Army commands requested the number of villages that x-th village was directly or indirectly connected with including itself.<br><br>R: The village destroyed last was rebuilt.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Output the answer to each of the Army commanders¡¯ request in order on a separate line.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">7 9
D 3
D 6
D 5
Q 4
Q 5
R
Q 4
R
Q 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
0
2
4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=POJ Monthly&source=1&searchmode=source'> POJ Monthly </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>LL</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=1540'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=1540'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=1540">Discuss</a> | <a href='note/note.php?pid=1540'>Note</a><br></td></tr></div></body></html>