<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3688</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Searchlights</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 327680/327680 K (Java/Others)<br>Total Submission(s): 267&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 73<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>There is a piece of grids land of size n¡Ám. Chandler and his team take responsibility to guard it. There are some searchlights on some pieces and each of them has a capability to lighten a distance towards four directions: north, south, east and west. Different searchlight has different lightening capability shown in levels. Searchlight with level k means that it can lighten k grids (including the gird that the searchlight stands in) along any of the four directions. Shown in following figure, there is a searchlight of level 3 and the shadow grids are ones that can be lightened by it. Particularly, searchlight of level 1 means that it can only lighten the grid in which the searchlight stands.<br><center><img src=../../data/images/3688-1.gif></center> <br>Each searchlight has a maximum level. You can decrease a searchlight¡¯s level to save the energy. A searchlight whose maximum level is k can be turned to level k, k-1, k-2, ¡­, 1 and 0. Level 0 means turning off the searchlight. <br><br>A grid is well-guarded if and only if at least one of the following two conditions is satisfied:<br>1.There is a searchlight in this grid, and it is not switched to level 0 (the light is on).<br>2.The grid is lightened by at least two searchlights. One lightens it in horizontal direction (east or west), and another lightens it in vertical direction (north or south).<br><br>Chandler asks you to help finding a solution that he can turn on some of the searchlights so that:<br>1.All the grids are well-guarded.<br>2.All the searchlights turned on are in a same level.<br>3.That same level mentioned above is as small as possible.<br>More specifically, if you choose a same level Q, then all the searchlights whose maximum level are less than Q have to be turned off. Please help him to find a solution with the minimum same level.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input file contains several test cases. <br><br>For each test case, the first line is two integers n and m, representing a grids land of size n¡Ám. (0&lt;n&lt;=100, 0&lt;m&lt;=10000). Following n lines describe an n¡Ám matrix in which ai,j means the maximum level of the searchlight in grid (i, j). ai,j can be zero, which means there is no searchlight on that grid. For all the cases, ai, j&lt;=10000.<br><br>The input file ends with a line containing two zeros.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a single line with an integer, representing the minimum level you have found. If there is no such a solution, output ¡°NO ANSWER!¡±</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 2
0 2
3 0
2 2
0 2
1 0
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
NO ANSWER!</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Asia Hangzhou Regional Contest &source=1&searchmode=source'> 2010 Asia Hangzhou Regional Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy&amp;zhengfeng</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3688'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3688'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3688">Discuss</a> | <a href='note/note.php?pid=3688'>Note</a><br></td></tr></div></body></html>