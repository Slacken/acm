<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3643</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Boolean String Expression</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 6&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 0<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Mike needs a bike and he decides to buy a second-hand one to save money. Luckily, he has found a second-hand goods BBS. However, there are so many messages there and it will be extremely boring for him to look through all those messages and figure out which one contains the information he needs. So he decides to write a program to do this.<br><br>The problem is: how to determine whether a message is about selling a bike. Mike decides to use a keyword-find-based algorithm. First choose some keywords and then the program checks whether a message contains these keywords or not. For example, he wants to find messages that contain 'bike'£¬and at the same time have 'sell' or don't have 'buy' (&quot;bike on sell&quot;, &quot;bike&quot;, &quot;sell bike and buy ¡­&quot;are all what he needs, but &quot;buy bike&quot; is not). Of course he wants his program can be used to handle things more than buying a bike.<br><br>As the string matching nature of the keyword-find-based algorithm, regular expression should be quite suitable here. But after a second thought, he throws it away: he even can't figure out what the corresponding regular expression is for a simple query &quot;don't have the word 'buy'&quot;.<br><br>After further thinking of this problem, Mike comes up with a great idea: combining string matching with Boolean algebra! He names it as &quot;Boolean String Expression&quot;.<br><br>Formally, a Boolean String Expression is composed of normal strings, ¡®&amp;¡¯(and), ¡®|¡¯(or) and ¡®!¡¯(not). A Boolean String Expression s matches a message M when:<br>1. s is a normal string, and it's a substring of M<br>2. s = a &amp; b, a and b are both Boolean String Expressions that match M<br>3. s = a | b, a and b are both Boolean String Expressions, and at least one of them matches M<br>4. s = ! a, a is Boolean String Expression which doesn't match M<br><br>Precedence of the three operators is: ¡®!¡¯ &gt; ¡®&amp;¡¯ &gt; ¡®|¡¯. And parenthesis can be used to change precedence of operators. Mike's query can be easily expressed as:<br>bike &amp; (sell | !buy)<br>Mike is very satisfied with this solution, but he comes to another problem: nearly all expressions can be changed into another form with the same meaning. For example, &quot;bike &amp; (sell | !buy)&quot; has a equivalent form of:<br>(bike &amp; sell) | (bike &amp; !buy)<br>It may seem to be obvious to you. However, it confuses Mike a lot and he needs your help to write a problem to check whether two Boolean String Expressions are equivalent. (Equivalent here means: all messages that match one expression will match the other, all messages that don't match one expression will not match the other too)<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line contains an integer indicating the number of test cases (&lt;=30).<br>Each test case contains three lines: The first line is an alphabet that contains only lower case letters. Suppose all messages we care about are only composed of those letters. The second line and 3rd line are two Boolean String Expressions. The expression contains only characters from the alphabet and '&amp;', '|', '!' , and its length is no more than 20.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a line of 'Yes' if the two expressions are equivalent, 'No' otherwise.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4
abcdefghijklmnopqrstuvwxyz
bike&(sell|!buy)
bike&sell|bike&!buy
abc
a&(b|c)
a&b|c
ab
ab&!a
ab&!b
ab
a|b
a|!a</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Yes
No
Yes
No

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
Case 3: Both expressions match nothing, so they are equivalent.
Case 4: Both expressions match all non-empty messages. However, the second expression can match an empty message, while the first one can¡¯t.

</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Asia Regional Hangzhou Site ¡ª¡ª Online Contest&source=1&searchmode=source'> 2010 Asia Regional Hangzhou Site ¡ª¡ª Online Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3643'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3643'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3643">Discuss</a> | <a href='note/note.php?pid=3643'>Note</a><br></td></tr></div></body></html>