<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3698</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Let the light guide us</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 62768/32768 K (Java/Others)<br>Total Submission(s): 238&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 73<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Plain of despair was once an ancient battlefield where those brave spirits had rested in peace for thousands of years. Actually no one dare step into this sacred land until the rumor that ¡°there is a huge gold mine underneath the plain¡± started to spread. <br><br>Recently an accident destroyed the eternal tranquility. Some greedy fools tried using powerful bombs to find the hidden treasure. Of course they failed and such behavior enraged those spirits--the consequence is that all the human villages nearby are haunted by ghosts.<br><br>In order to stop those ghosts as soon as possible, Panda the Archmage and Facer the great architect figure out a nice plan. Since the plain can be represented as grids of N rows and M columns, the plan is that we choose ONLY ONE cell in EACH ROW to build a magic tower so that each tower can use holy light to protect the entire ROW, and finally the whole plain can be covered and all spirits can rest in peace again. It will cost different time to build up a magic tower in different cells. The target is to minimize the total time of building all N towers, one in each row.<br><br>¡°Ah, we might have some difficulties.¡± said Panda, ¡°In order to control the towers correctly, we must guarantee that every two towers in two consecutive rows share a common magic area.¡±<br><br>¡°What?¡±<br><br>¡°Specifically, if we build a tower in cell (i,j) and another tower in cell (i+1,k), then we shall have |j-k|¡Üf(i,j)+f(i+1,k). Here, f(i,j) means the scale of magic flow in cell (i,j).¡±<br><br>¡°How?¡±<br><br>¡°Ur, I forgot that you cannot sense the magic power. Here is a map which shows the scale of magic flows in each cell. And remember that the constraint holds for every two consecutive rows.¡±<br><br>¡°Understood.¡±<br><br>¡°Excellent! Let¡¯s get started!¡±<br><br>Would you mind helping them?<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases. <br><br>Each test case starts with a line containing 2 integers N and M (2&lt;=N&lt;=100,1&lt;=M&lt;=5000), representing that the plain consists N rows and M columns.<br><br>The following N lines contain M integers each, forming a matrix T of N¡ÁM. The j-th element in row i (Tij) represents the time cost of building a magic tower in cell (i, j). (0&lt;=Tij&lt;=100000£©<br><br>The following N lines contain M integers each, forming a matrix F of N¡ÁM. The j-th element in row i (Fij) represents the scale of magic flows in cell (i, j). (0&lt;=Fij&lt;=100000£©<br><br>For each test case, there is always a solution satisfying the constraints.<br><br>The input ends with a test case of N=0 and M=0.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a line with a single integer, which is the minimum time cost to finish all magic towers.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 5
9 5 3 8 7
8 2 6 8 9
1 9 7 8 6
0 1 0 1 2
1 0 2 1 1
0 2 1 0 2
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">10</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Asia Fuzhou Regional Contest&source=1&searchmode=source'> 2010 Asia Fuzhou Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>chenyongfu</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3698'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3698'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3698">Discuss</a> | <a href='note/note.php?pid=3698'>Note</a><br></td></tr></div></body></html>