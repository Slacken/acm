<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3945</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>The irRegularGame of Life</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 4000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 104&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 39<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The irRegularGame of Life(http://www.bilibili.tv/video/av94917/) is an interesting game, it¡¯s based on the same cell rules as Conway's original, with the addition of limitations on initial conditions, and goals for completing levels.<br><br>The Conway¡¯s original game of life rules is a &quot;2-Dimensional cellular automaton&quot;. It was invented by British mathematician John Conway in 1970.It is not a game in the video game sense, but consists of a 2-D grid of cells. The game of life shouldn't to be confused with Milton Bradley's Board game of the same name.<br>Cells in the grid follow a few simple mathematical rules that determine whether they will live, die or multiply in the next generation. <br>Specifically, each cell interacts with its 8 horizontal, vertical, and diagonal neighbours, according to these 4 simple rules below:<br>1. Any live cell with fewer than 2 live neighbours dies through loneliness.<br>2. Any live cell with more than 3 live neighbours dies through overcrowding.<br>3. Any live cell with 2 or 3 live neighbours lives to the next generation.<br>4. Any dead cell with exactly 3 live neighbours comes to live. <br><center><img src=../../data/images/C363-1006-1.jpg></center> <br>Despite having such simple rules, the patterns that evolve are remarkable and can vary greatly from only small differences in initial conditions. <br>The game of life has fascinated mathematicians, computer scientists and nerdy types for decades. <br><center><img src=../../data/images/C363-1006-2.jpg></center> <br>This picture shows the rule of The irRegularGame of Life.<br><br>Sakuya thought this game is too simple, so he added some rules.<br>1.We have K (1&lt;=K&lt;=10) independent boxes in every level, and each box contains 4*4 grids.<br>2.The goal to pass a level is the sum of live cells in all boxes are exactly N (0&lt;=N&lt;=20) after T (0&lt;=T&lt;=200000) generations.<br>3.For those boxes, we can add at most M (0&lt;=M&lt;=20) cells.<br><br>Sakuya want know how many ways to pass one level?<br><br>As an example, initially we have one box as below.<br><img src=../../data/images/C363-1006-3.jpg><br>The goal is to have exactly 5 live cells after 10 generations, and we can add at most one cell into the box.<br>There are 9 different ways to pass this level.<br><center><img src=../../data/images/c363-1006-4.jpg></center> </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>First an integer L (L &lt;= 50), indicates there are L different levels.<br>For every level, the first line contains 4 integers, they are K, M, T and N which mentioned above.<br>Then, there are K 4*4 01-matrices follow, indicating the initial state of each box, 0 stands for an empty cell and 1 stands for an alive cell.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each level, you should output &quot;Case #C: &quot; first, where C indicates the level number and counts from 1. Then output the answer. There may be a great deal of ways, just mod 1000000009</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2

1 1 10 5
0 0 0 0
0 1 0 0
1 0 1 0
0 1 0 0

2 3 0 3
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case #1: 9
Case #2: 4960
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
ATTENTION: It is to ALL the box that at most M cells are available to be add into, not to EACH box. 
In the second sample, we can add 3 cells into two empty boxes and the goal is the sum of live cells in all boxes are exactly 3 after 0 generation, so we have C(32,3) = 4960 different ways.
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>UESTC_Mzry1992</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 11 - Host by UESTC&source=1&searchmode=source'> 2011 Multi-University Training Contest 11 - Host by UESTC </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>xubiao</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3945'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3945'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3945">Discuss</a> | <a href='note/note.php?pid=3945'>Note</a><br></td></tr></div></body></html>