<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3216</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Graph of Black and White</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 4000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 44&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 13<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Once upon a time, there was a graph. Actually, it was an undirected forest, i.e., an undirected graph without circles. There were N nodes in this forest, numbered from 1 to N inclusively, with each node colored black or white. Elves had been living in the forest for many years. Their homes were inside the nodes, and sometimes they would move their homes or visit other elves living in another node. However, they could only move between nodes that were connected by an edge or a path formed by several end-to-end connected edges. In other words, they could only move in the same tree. If two nodes were not connected, the elves could not travel between them. When they were passing a node, including the starting and the ending ones, they should use black or white magic power according to the color of the node. Waste is criminal, so during a journey the elves never pass a node twice. <br><br>The structure of the forest might change, when no elves were travelling. Two disconnected nodes might be connected by a new edge between them, or an existing edge might disappear, or the color of a node might change. Anyway, there would never be circles in the forest, so the forest remained a forest. <b>THUS HARMONY LONG LASTS!</b><br><br>Elves were intelligent. They knew everything happening in the forest. And they knew how much black and white magic power was used when they travel. Why? Because YY, the most intelligent one elf, simulated everything and told them.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Input contains several test cases.<br><br>For each test case, the first line contains two positive integers, N (N ¡Ü 10000) and M (M ¡Ü 100000), indicating the number of nodes in the graph and the number of operations that YY should simulate. At the beginning of his simulation, there were not any edge in the forest.<br><br>The following lines contains N space separated characters, each being ¡®B¡¯ or ¡®W¡¯ (quotes for clarity), the ith of which indicates the color of the node numbered i, black or white.<br><br>M lines follow, indicating the M operations to simulate. For each line, it will be one of the four types:<br><br>add u v<br>The two nodes numbered u and v (1¡Üu, v¡ÜN, and u¡Ùv) are connected by a new edge. It is guaranteed that these two nodes are not connected before this operation.<br><br>del u v<br>The edge between the two nodes numbered u and v (1¡Üu, v¡ÜN, and u¡Ùv) disappears. It is guaranteed that this edge exists before this operation.<br><br>set u c<br>The color of the node numbered u (1¡Üu¡ÜN) is set to c (c=¡¯B¡¯ or ¡®W¡¯, quotes for clarity).<br><br>query u v<br>Now YY tells the elves the number of black and white nodes that have to be passed when travelling between nodes numbered u and v (1¡Üu, v¡ÜN) inclusively, or tells them the journey is impossible. <br><br>Input ends with N=M=0.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each query in each test case, if such a journey is possible, output one line with two space-separated integers, the number of black and white nodes on the path between the two nodes. If it is impossible, just output one line containing the number -1.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 8
B W B
query 1 2
add 1 2
add 2 3
query 1 3
del 2 3
add 1 3
set 1 W
query 3 2
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">-1
2 1
1 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Shanghai Network Contest Host by DHU&source=1&searchmode=source'> 2009 Shanghai Network Contest Host by DHU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhuweicong</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3216'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3216'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3216">Discuss</a> | <a href='note/note.php?pid=3216'>Note</a><br></td></tr></div></body></html>