<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2777</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Jack of All Trades</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 66&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 10<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Jack Barter is a wheeler-dealer of the highest sort. He'll trade anything for anything, as long as he gets a good deal. Recently, he wanted to trade some red agate marbles for some goldfish. Jack's friend Amanda was willing to trade him 1 goldfish for 2 red agate marbles. But Jack did some more digging and found another friend Chuck who was willing to trade him 5 plastic shovels for 3 marbles while Amanda was willing to trade 1 goldfish for 3 plastic shovels. Jack realized that he could get a better deal going through Chuck (1.8 marbles per goldfish) than by trading his marbles directly to Amanda (2 marbles per goldfish).<br><br>Jack revels in transactions like these, but he limits the number of other people involved in a chain of transactions to 9 (otherwise things can get a bit out of hand). Normally Jack would use a little program he wrote to do all the necessary calculations to find the optimal deal, but he recently traded away his computer for a fine set of ivory-handled toothpicks. So Jack needs your help. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Input will consist of multiple test cases. The first line of the file will contain an integer n  indicating the number of test cases in the file. Each test case will start with a line containing two strings and a positive integer m&lt;=50 . The first string denotes the items that Jack wants, and the second string identifies the items Jack is willing to trade. After this will be m  lines of the form<br><br><br>a1 name1 a2 name2<br><br><br>indicating that some friend of Jack's is willing to trade an amount a1 of item name1 for an amount a2 of item name2 . (Note this does not imply the friend is also willing to trade a2 of item name2 for a1 of item name1 .) The values of a1 and a2 will be positive and &lt;=20 . No person will ever need more than 2^31 - 1 items to complete a successful trade. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output the phrase `Case i :' (where i  is the case number starting at 1) followed by the best possible ratio that Jack can obtain. Output the ratio using 5 significant digits, rounded. Follow this by a single space and then the number of ways that Jack could obtain this ratio. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 
goldfish marbles 3 
1 goldfish 2 marbles 
5 shovels 3 marbles 
1 goldfish 3 shovels 
this that 4 
7 this 2 that 
14 this 4 that 
7 this 2 theother 
1 theother 1 that</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 1.8000 1 
Case 2: 0.28571 3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 East Central Regional Contest&source=1&searchmode=source'> 2008 East Central Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2777'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2777'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2777">Discuss</a> | <a href='note/note.php?pid=2777'>Note</a><br></td></tr></div></body></html>