<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3616</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Escape From Huarong Road</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 116&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 60<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The Chibi Battle is perhaps the most famous battle in the history of China. Liu Bei and Sun Quan won the battle after using a series of wonderful stratagem. Now, they are going to catch the leader of their enemy Cao Cao. <br><br>In order to help Cao Cao to escape, the soldiers of Cao Cao have been divided into several parts, and Cao Cao is in one of these part. Now they are all in a rectangle area which can be divided into many squares of the equal size. Once the soldiers get out of this area, they escape successfully. <br><br>Because Liu Bei and Sun Quan don't know exactly which part Cao Cao is in, so they all Cao Cao's soldiers. <br><br>In this area, some squares are lawns that can be passed, while some squares are Marshes that can't be passed. Liu Bei and SunQuan decide to set fire on lawns to those squares can't be passed. Because some reasons, set fire on different squares needs different length of time. And they can only set fire on one square at the same time. Now, Cao Cao and all his soldiers are having rest and you can assume that they won't move. Liu Bei and SunQuan want to know how much time they need at least to set fire to make Cao Cao and all his soldiers can't escape any way when they want to move. Can you help them? <br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line in the input file is a single integer: T (1 ¡Ü T ¡Ü 10), representing the number of test cases. For each test case, in the first line there are two integers: r and c (1 ¡Ü r, c ¡Ü 30) - the height and length of the area. Then there are r lines, in each line there are c integers. The j-th integer in the i-th line is m<sub>ij</sub>. Each of these integers describes a square: if t<sub>ij</sub> is positive, then the square is a lawn and it needs m<sub>ij</sub> unit of time to set fire on it; if m<sub>ij</sub> is 0, it means some soldiers of Cao Cao are having rest in this square; if m<sub>ij</sub> is -1, means the square can't be passed. <br><br>When Cao Cao and his soldiers move, they can only move to a square that share an edge with the square they are in just now. All positive integers in the input file are smaller or equal to 100. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a single integer, means the number of unit of time Liu Bei and Sun Quan need to set fire so that Cao Cao and his soldiers can't get escape. <br><br>It is guaranted that the answer is exists. <br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
4 3
1 2 1
1 10 1
1 0 -1
1 1 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">6</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨18£©¡ª¡ªHost by TJU &source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨18£©¡ª¡ªHost by TJU  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3616'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3616'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3616">Discuss</a> | <a href='note/note.php?pid=3616'>Note</a><br></td></tr></div></body></html>