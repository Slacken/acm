<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3120</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Dolphin</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 3000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 131072/131072 K (Java/Others)<br>Total Submission(s): 464&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 129<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Dolphins are marine mammals that are closely related to whales and porpoises. They might have some kind of the biggest brains in the water, but are dolphins really smart? Some scientists say that they use their big brains to stay warm in the sea, rather than for lots of thinking. Obviously those scientists don¡¯t think dolphins are smart.<br> We know that the brain is made up of two types of cells ¨C neurons and glia. Neurons do the thinking, while glia do things like keeping the brain warm to help the neurons. After looking at how dolphins¡¯ brains are put together, they claim that dolphins have lots of glia and not many neurons.<br>In order to find out how smart the dolphins are, we throw one of them into a maze we've just created, to see how long it'll take the dolphin to get out.<br>The maze consists of nodes and bidirectional edges connecting them. <br>The dolphin needs power to swim, so we place exactly one fish at each node for him to enjoy.<br>The dolphin is not interested in eating the same kind of fish more than once, but he can't resist any food if it's just in front to him! As a result, the dolphin decided to PLAN a route before going, so that it will not REACH any kind of fish more than once.<br>Given the information above, can you tell me the minimum time that the dolphin needs to get out? <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line consists of an integer T, indicating the number of test cases.<br>The first line of each case consists of four integers N, M, S and E, indicating the number of nodes, the number of edges, the starting node and destination.<br>Each of the next M lines consists of three integers U, V, C, indicating that there is an edge with length C between node U and V. It will take a dolphin C time to pass this edge.<br>The next line consists of N integers. Ki indicates the label of which kind fishes i-th node has.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Output the minimum time that a dolphin needs to get to the destination on a single line. If a dolphin can never get to the destination, please output -1.<br>Constraints<br>0 &lt; T &lt;= 20<br>2 &lt;= N &lt;= 100; 0 &lt;= M &lt;= 10000; 0 &lt;= S, E &lt; N<br>0 &lt;= U, V &lt; N; 0 &lt; C &lt;= 1000<br>0 &lt;= Ki &lt; 1000<br>There may be more than one edge between two nodes, and may be loop, an edge that begins and ends both on the same vertex. All edges are bidirectional.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
2 1 0 1
0 1 1
0 0
4 4 0 3
0 1 1
1 3 1
0 2 2
2 3 2
0 0 1 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">-1
4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Asia Wuhan Regional Contest Online&source=1&searchmode=source'> 2009 Asia Wuhan Regional Contest Online </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3120'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3120'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3120">Discuss</a> | <a href='note/note.php?pid=3120'>Note</a><br></td></tr></div></body></html>