<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3593</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>The most powerful force</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 16000/8000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 349&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 92<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The leaders of AC country made a decision to regain the TW Island. But they have to face the powerful force from USB. So the leaders have to hire some excellent soldiers from the training base called ALPC to format the most powerful force.<br>The followings are the consists of ALPC:<br>1.&nbsp;&nbsp;There are more than one alpcs who are generals, like alpc04.<br>2.&nbsp;&nbsp;Every alpc has a direct superior, except the generals.<br>3.&nbsp;&nbsp;The alpc who has underling is an officer (Every officer¡¯ number is no more than 500, like alpc21, alpc32).<br>4.&nbsp;&nbsp;If send one alpc to the war, so will his direct superior. Of course the general¡¯s direct superior is himself.<br>5.&nbsp;&nbsp;Every alpc has two values. Vi is the fighting strength and Ci is the cost that the leader have to pay for the soldier.<br><br>Due to the AC country has limited financial resources, the leaders want to format the most powerful force with the cost not exceed G. Obviously, it is an uphill task! Therefore, the leaders of the AC country have assigned the task to alpc72 because of the outstanding behavior he had done at the ACM/ICPC. But alpc72 has been lost in hunting PLMM nowadays, so that he has no time to deal with this problem. What¡¯s more, he left it to you.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There will have several test cases. <br>The first line has two integers N and G, which stand for the total number of soldiers and the maximum cost. Soldiers numbered consequently from 1 to N. (1&lt;=N&lt;=100000, 1&lt;=G&lt;=10000)<br>The next N lines, each has three integers Ci, Vi and Fi. They are the cost, the measure of power and the direct superior of the ith soldier. (0&lt;=Ci&lt;=1000000,  0&lt;=Vi&lt;=1000000)<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Output one integer (must within 32 bits)as the maximum fighting strength of the most powerful force.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5 10
1 2 1
10 5 2
1 1 1 
1 1 1
1 1 3
5 10
1 2 1
2 4 2
1 1 1 
1 1 1
1 1 3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5
9

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>Special Thanks to alpc30.</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>alpc32</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨16£©¡ª¡ªHost by NUDT&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨16£©¡ª¡ªHost by NUDT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhengfeng</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3593'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3593'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3593">Discuss</a> | <a href='note/note.php?pid=3593'>Note</a><br></td></tr></div></body></html>