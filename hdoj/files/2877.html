<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2877</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Florid Banner</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 350&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 60<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Adam C. Murphy loves shopping. One day, when he was wandering along the avenue, he discovered several stores with florid banners. (A 2*5 example is shown below)<br><center><img src=../../../data/images/convip3-1006-1.JPG></center> <br>He found them fantastic and decided to get one in order to decorate his fresh new house. Unfortunately, no one meets Adam¡¯s requirement, after visiting all stores nearby. What was worse, all banners left in the stores only have width 1. So he decided to make one himself by sewing them together.<br>Adam wants to make a banner exactly as he designed. He didn¡¯t want to flip or rotate the materials he had, since he believed that keep it in its original way is more beautiful. And he didn¡¯t want to cut the banners for the same reason.<br>Each material had different prices, so he wants to make his florid banner with minimum cost.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input consists of one or more test cases.<br>Each test case contains two parts.<br>The first part of the input describes the banner Mr. Murphy designed.<br>First line: <br>Two integers M (0&lt;M&lt;=10) and N (0&lt;N&lt;=10,000), describes the width and the length of the banner.<br><br>Second line: <br>One integer t states that the banner has t regions.<br><br>Following t lines: <br>Each line has 5 integers x1,y1,x2,y2,c, represents a region from (x1,y1), the left bottom corner, to (x2,y2), the right top corner, and the color type of this region is c.<br>The whole banner is M*N, with its left bottom located at (0, 0). It is guaranteed that t regions can exactly cover the whole banner once. (0&lt;=x1&lt;x2&lt;=M, 0&lt;=y1&lt;y2&lt;=N)<br><br>The second part describes the materials left in the store. No need to worry about the number of them, because they are infinity.<br>The first line: <br>The number of materials fn(0&lt;=fn&lt;=10000)<br><br>Following fn lines: <br>Each line represents one kind of material. Following an integer P(P&gt;0) indicates the price, and an integer L(1&lt;=L&lt;=20) indicates the length of this banner. Then L integers for this material, i-th number indicates the color at position range from (0,i-1) to (1,i).<br><br>You may assume that the number of colors is no more than 30.<br>Input will be terminated by EOF.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output one line represents the minimum cost of the banner, or ¡®impossible¡¯ if Adam can¡¯t make one anyhow.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 5
7
0 0 2 1 0
1 1 2 3 0
0 1 1 2 1
0 2 1 3 2
0 3 2 4 1
0 4 1 5 3
1 4 2 5 2
5
1 3 0 0 0
2 3 2 1 3
2 3 0 1 2
1 2 1 3
5 1 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">15
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
Hint

The pattern of the sample is as follows:
<center><img src='../../../data/images/convip3-1006-2.JPG'></center> 
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Multi-University Training Contest 8 - Host by BJNU&source=1&searchmode=source'> 2009 Multi-University Training Contest 8 - Host by BJNU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>gaojie</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2877'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2877'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2877">Discuss</a> | <a href='note/note.php?pid=2877'>Note</a><br></td></tr></div></body></html>