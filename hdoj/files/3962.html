<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3962</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Microgene</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/65536 K (Java/Others)<br>Total Submission(s): 126&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 90<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>sevenzero is very interesting in Bioinformation and have done some research on it. One day, sevenzero found a phenomenon called Microgene. Microgene is a special fragment in the DNA, and different Microgenes may have the same hereditary effect. Microgene works if and only if there are more than one Microgenes(Microgenes may overlap) with the same hereditary effect in the DNA. To finish his paper, sevenzero wants to know how many different DNAs with length L which contain the hereditary effect caused by Microgenes.<br><br>To simplify the problem, a DNA or a Microgene is considerd as a string consisting of character 'A', 'T', 'C' and 'G'. And a Microgene is in the DNA if the Microgene string is the substring of the DNA string. All Microgenes given are different and with the same hereditary effect. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several test cases in the input. Each case begins with a line with an integer N (1 ¡Ü N ¡Ü 6) and L (1 ¡Ü N ¡Ü 1000000), denoting the number of Microgenes and the length of DNA. The following N lines contain N strings representing the Microgenes.The length of the Microgene is no more than 5. The input is terminated by EOF. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>One line for each case, the answer modulo 10007.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 3
AT
TC
2 3
ATC
T
3 1000000
ATCG
TCGT
CTAG</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
11
5063</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 13 - Host by HIT &source=1&searchmode=source'> 2011 Multi-University Training Contest 13 - Host by HIT  </a> </div> <div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3962'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3962'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3962">Discuss</a> | <a href='note/note.php?pid=3962'>Note</a><br></td></tr></div></body></html>