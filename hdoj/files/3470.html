<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3470</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Chinese Paper Folding</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/5000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 55&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 11<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Chinese Paper Folding, or Zhezhi, is the art of folding paper that originated in China. It is the predecessor of origami.<br><br>Here we only consider a simplified problem. You are given a paper L cm by W cm in size and a list of operations to fold it.<br><br>Four types of operation are listed below: <br>1.&nbsp;&nbsp;L v , fold the left part of paper along the straight line x = v.<br>2.&nbsp;&nbsp;R v , fold the right part of paper along the straight line x = v.<br>3.&nbsp;&nbsp;U v , fold the upper part of paper along the straight line y = v.<br>4.&nbsp;&nbsp;D v , fold the lower part of paper along the straight line y = v.<br>Note that v is always an integer.<br><br><center><img src=../../data/images/C284-1002-1.jpg></center> <br><br>We define the left-lower corner of current paper as (0, 0) at every step (refer to the picture below). It is guaranteed that each operation is legal, that is, each operation is asked to fold paper of a positive area.<br><br><center><img src=../../data/images/C284-1002-2.jpg></center> <br><br>It is obvious that folding will make the straight lines into creases. We wonder the total length of all creases when paper is completely unfolded.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>In the first line there is an integer T, indicates the number of test cases. (T &lt;= 50)<br><br>For each case, the first line is a pair of integers L and W (1 &lt;= L, W &lt;= 1,000,000), which stands for the length and width of the paper. In the second line, an integer K stands for the number of operations. (K &lt;= 100000) Then K lines follow, each stands for an operation described above.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, output ¡°Case x: R&quot; on a single line, in which x is the case number counted from one, R is the total length of all creases.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
50 50
4
L 30
D 5
R 3
U 5
65536 1
16
L 32768
L 16384
R 8192
R 4096
L 2048
R 1024
L 512
R 256
R 128
L 64
R 32
R 16
L 8
R 4
L 2
R 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 250
Case 2: 65535</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>love8909</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨4£©¡ª¡ªHost by UESTC&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨4£©¡ª¡ªHost by UESTC </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhengfeng</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3470'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3470'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3470">Discuss</a> | <a href='note/note.php?pid=3470'>Note</a><br></td></tr></div></body></html>