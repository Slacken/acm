<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3758</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Factorial Simplification</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 4000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 325&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 90<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Peter is working on a combinatorial problem. He has carried out quite lengthy derivations and got a resulting formula that is a ratio of two products of factorials like this:<br><center><img src=http://acm.hdu.edu.cn/data/images/C326_1006_1.png></center><br><br>This does not surprise Peter, since factorials appear quite often in various combinatorial formulae, because n! represents the number of transpositions of n elements - one of the basic combinatorial objects.<br>However, Peter might have made a mistake in his derivations. He knows that the result should be an integer number and he needs to check this first. For an integer result Peter wants to simplify this formula to get a better feeling of its actual combinatorial significance. He wants to represent the same number as a product of factorials like this.<br><br><center><img src=http://acm.hdu.edu.cn/data/images/C326_1006_2.png></center><br>where all ri are distinct integer numbers greater than one in the descending order (r<sub>i</sub> &gt; r<sub>i+1</sub> &gt; 1), si and t are positive integers. Among all the possible representations in this form, Peter is interested in one where r<sub>1</sub> is the largest possible number, among those in the one where s<sub>1</sub> is the largest possible number; among those in the one where r<sub>2</sub> is the largest possible number; among those in the one where s<sub>2</sub> is the largest possible number; etc, until the remaining t cannot be further represented in this form. Peter does not care about the actual value of t. He wants to know what is the factorial-product part of his result.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input begins with an integer T. The next T blocks each represents a case. The first line of each case contains two integer numbers n and m (1 ¡Ü n, m ¡Ü 1000). The second line contains n integer numbers pi (1 ¡Ü pi ¡Ü 10 000) separated by spaces. The third line contains m integer numbers qi (1 ¡Ü qi ¡Ü 10 000) separated by spaces.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, on the first line of the output write a single integer number k. Write k = -1 if the ratio of the given factorial products is not an integer. Write k = 0 if the ratio is an integer but it cannot be represented in the desired form. Write k &gt; 0 followed by k lines if the ratio can be represented by a factorial product as described in the problem statement. On each of the following k lines write two integers ri and si (for i = 1 ... k) separated by a space.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
1 2
6
4 4
1 2
6
3 4
4 2
9 2 2 2
3 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">-1
0
2
7 1
2 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>Andrey Stankevich</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Northeastern European Regional Contest&source=1&searchmode=source'> 2010 Northeastern European Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>notonlysuccess</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3758'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3758'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3758">Discuss</a> | <a href='note/note.php?pid=3758'>Note</a><br></td></tr></div></body></html>