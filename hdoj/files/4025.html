<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 4025</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Equation of XOR</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65768/65768 K (Java/Others)<br>Total Submission(s): 396&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 91<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Recently, Jimmy is learning about linear algebra from Blue Mary while having the course of Boolean algebra in class offered by Prof. Z. Since Jimmy has been thoroughly bored by the boring homework assigned by two teachers, evil Jimmy plans to set a hard question to baffle them as revenge for their heavy tasks. As a result, Jimmy comes up with an idea that merging the knowledge from both the two classes and constructs a complicate problem: the XOR equation system.<br>Let¡¯s consider the following equations:<br>(a11 . x1) ^ (a12 . x2) ^ ¡­ ^ (a1m . xm) = 0 <br>(a21 . x1) ^ (a22 . x2) ^ ¡­ ^ (a2m . xm) = 0 <br>¡­<br>(an1 . x1) ^ (an2 . x2) ^ ¡­ ^ (anm . xm) = 0<br>which satisfies the following conditions:<br>1.&nbsp;&nbsp;aij  in {0,1} &nbsp;&nbsp;for 1 ¡Ü i ¡Ü n and 1 ¡Ü j ¡Ü m;<br>2.&nbsp;&nbsp;xi  in Si where Si is a subset of {0,1,2,3}, 1 ¡Ü i ¡Ü m;<br>3.&nbsp;&nbsp;|Si| ¡Ü 3, 1 ¡Ü i ¡Ü m;<br>4.&nbsp;&nbsp;1¡Ün ¡Ü 30, 1 ¡Ü m ¡Ü 22.<br><br>In the system of equations, operation ¡° . ¡° denotes the multiplication operation while ¡° ^ ¡± is for bitwise XOR. Moreover, the bitwise XOR takes two bit patterns of equal length and performs the logical XOR operation on each pair of corresponding bits. The result in each position is 1 if the two bits are different, and 0 if they are the same.<br>Rather than expecting a solution of a specified equation system, Jimmy would like to ask the teachers to calculate that how many distinct solutions can satisfy a given equation system. What a confusing puzzle! Help Jimmy¡¯s teachers please!<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several test cases. The first line of input is a single positive integer T (&lt;= 15) indicating the number of test cases, then T cases follow.<br>For each test case, the first line contains two integers N and M giving the two dimensions of the equation system respectively where N is the number of rows and M for columns. Then N lines are following, each line contains m integers. Item at line i and column j represents aij. The next m lines are descriptions of Si that the leading integer K denotes the number of elements in Si and the following K integers represent elements.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output one line containing a single integer which represents the answer of this case.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
1 2
1 1
3 0 1 2
2 3 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=The 36th ACM/ICPC Asia Regional Shanghai Site ¡ª¡ª Online Contest&source=1&searchmode=source'> The 36th ACM/ICPC Asia Regional Shanghai Site ¡ª¡ª Online Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4025'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4025'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4025">Discuss</a> | <a href='note/note.php?pid=4025'>Note</a><br></td></tr></div></body></html>