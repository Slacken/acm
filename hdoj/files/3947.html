<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3947</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>River Problem</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 6000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/65536 K (Java/Others)<br>Total Submission(s): 317&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 138<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The River of Bitland is now heavily polluted. To solve this problem, the King of Bitland decides to use some kinds of chemicals to make the river clean again.<br><br>The structure of the river contains n nodes and exactly n-1 edges between those nodes. It's just the same as all the rivers in this world: The edges are all unidirectional to represent water flows. There are source points, from which the water flows, and there is exactly one sink node, at which all parts of the river meet together and run into the sea. The water always flows from sources to sink, so from any nodes we can find a directed path that leads to the sink node. Note that the sink node is always labeled 1.<br><br>As you can see, some parts of the river are polluted, and we set a weight Wi for each edge to show how heavily polluted this edge is. We have m kinds of chemicals to clean the river. The i-th chemical can decrease the weight for all edges in the path from Ui to Vi by exactly 1. Moreover, we can use this kind of chemical for Li times, the cost for each time is Ci. Note that you can still use the chemical even if the weight of edges are 0, but the weight of that edge will not decrease this time.<br><br>When the weight of all edges are 0, the river is cleaned, please help us to clean the river with the least cost.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of the input is an integer T representing the number of test cases. The following T blocks each represents a test case.<br><br>The first line of each block contains a number n (2&lt;=n&lt;=150)  representing the number of nodes. The following n-1 lines each contains 3 numbers U, V, and W, means there is a directed edge from U to V, and the pollution weight of this edge is W. (1&lt;=U,V&lt;=n, 0&lt;=W&lt;=20)<br><br>Then follows an number m (1&lt;=m&lt;=2000), representing the number of chemical kinds. The following m lines each contains 4 numbers Ui, Vi, Li and Ci (1&lt;=Ui,Vi&lt;=n, 1&lt;=Li&lt;=20, 1&lt;=Ci&lt;=1000), describing a kind of chemical, as described above. It is guaranteed that from Ui we can always find a directed path to Vi.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>First output &quot;Case #k: &quot;, where k is the case numbers, then follows a number indicating the least cost you are required to calculate, if the answer does not exist, output &quot;-1&quot; instead.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
3
2 1 2
3 1 1
1
3 1 2 2
3
2 1 2
3 1 1
2
3 1 2 2
2 1 2 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case #1: -1
Case #2: 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>Thost &amp; Kennethsnow</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 11 - Host by UESTC&source=1&searchmode=source'> 2011 Multi-University Training Contest 11 - Host by UESTC </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>xubiao</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3947'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3947'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3947">Discuss</a> | <a href='note/note.php?pid=3947'>Note</a><br></td></tr></div></body></html>