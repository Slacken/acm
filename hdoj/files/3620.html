<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3620</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Ice-Skating</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 187&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 60<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>FJ becomes interested in ice-skating these days. Every weekends, he goes to the rink in his town. The rink is a rectangle that made up of r rows and c colomns of small squares. Some of squares are damaged and skating on these squares are forbidden. <br><br>FJ is a beginner, and he can only do a sequence of k actions one after another. One action means skating forward at most l squares (Doesn't include the square he start at) in a certain direction (Up, Down, Left and Right). Notice that he can't skate on broken squares. <br><br>Now the problem is: Given the rink and the sequence of actions, how long can FJ skating at most. <br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of input file is a single integer T (1 ¡Ü T ¡Ü 10) - the number of test cases. For each test case, in the first line there are 5 integers: r, c, x, y, k. The meaning of r, c and k are described as above. x and y means FJ is at the square in the x-th row (counting from the top and start from 1) and y-th colomn (counting from the left side and start from 1). Then there are r lines, describing the rink - '.' means good squares, and 'x' means broken squares. Then there are k lines, giving the k actions in order. Each of these lines contain 2 integers: l and d, d ¡Ê {1, 2, 3, 4}, 1 represent upward, 2 represent left, 3 represent downward and 4 represent right. <br><br>(1 ¡Ü r, c ¡Ü 200; 1 ¡Ü k ¡Ü 200); <br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Output a single integer, the maxmum number of square FJ can skate throuth. If FJ skates through a square twice, count twice. <br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
4 5 4 1 3
..xx.
.....
...x.
.....
3 4
2 1
2 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">6

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
For the sample input, FJ can skate in this way: 
<img src='../../data/images/3620-1.gif'>
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨18£©¡ª¡ªHost by TJU &source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨18£©¡ª¡ªHost by TJU  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3620'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3620'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3620">Discuss</a> | <a href='note/note.php?pid=3620'>Note</a><br></td></tr></div></body></html>