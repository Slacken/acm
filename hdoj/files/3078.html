<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3078</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Network</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/65536 K (Java/Others)<br>Total Submission(s): 62&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 36<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The ALPC company is now working on his own network system, which is connecting all N ALPC department. To economize on spending, the backbone network has only one router for each department, and N-1 optical fiber in total to connect all routers.<br>The usual way to measure connecting speed is lag, or network latency, referring the time taken for a sent packet of data to be received at the other end.<br>Now the network is on trial, and new photonic crystal fibers designed by ALPC42 is trying out, the lag on fibers can be ignored. That means, lag happened when message transport through the router. ALPC42 is trying to change routers to make the network faster, now he want to know that, which router, in any exactly time, between any pair of nodes, the K-th high latency is. He needs your help.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are only one test case in input file.<br>Your program is able to get the information of N routers and N-1 fiber connections from input, and Q questions for two condition: 1. For some reason, the latency of one router changed. 2. Querying the K-th longest lag router between two routers.<br>For each data case, two integers N and Q for first line. 0&lt;=N&lt;=80000, 0&lt;=Q&lt;=30000.<br>Then n integers in second line refer to the latency of each router in the very beginning.<br>Then N-1 lines followed, contains two integers x and y for each, telling there is a fiber connect router x and router y.<br>Then q lines followed to describe questions, three numbers k, a, b for each line. If k=0, Telling the latency of router a, Ta changed to b; if k&gt;0, asking the latency of the k-th longest lag router between a and b (include router a and b). 0&lt;=b&lt;100000000.<br>A blank line follows after each case.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each question k&gt;0, print a line to answer the latency time. Once there are less than k routers in the way, print &quot;invalid request!&quot; instead.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5 5
5 1 2 3 4
3 1
2 1
4 3
5 3
2 4 5
0 1 2
2 2 3
2 1 4
3 3 5</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
2
2
invalid request!</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Multi-University Training Contest 17 - Host by NUDT&source=1&searchmode=source'> 2009 Multi-University Training Contest 17 - Host by NUDT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3078'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3078'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3078">Discuss</a> | <a href='note/note.php?pid=3078'>Note</a><br></td></tr></div></body></html>