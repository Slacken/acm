<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3978</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Evil teacher's Final Problem</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 45000/15000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 92&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 30<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>In the math class, the evil teacher gave you one unprecedented problem!<br><br>Here f(n) is the n-th fibonacci number (n &gt;= 0)! Where f(0) = f(1) = 1 and for any n &gt; 1, f(n) = f(n - 1) + f(n - 2). For example, f(2) = 2, f(3) = 3, f(4) = 5 ...<br><br>The teacher used to let you calculate f(n) mod p where n &lt;= 10^18 and p &lt;= 10^9, however , as an ACMER, you may just kill it in seconds! The evil teacher is mad about this. As you kill the Evil teacher.s problem in second too!!! now he let you calculate G(n,k) .Here G(n,0) = f(n) , G(n,i) = f( G(n,i-1) ) (k &gt;= i &gt;= 1). However the G(n,k) may be so large ,so you just need to output the remainder of the answer after divided by p.<br><br>Note: This problem is the evil teacher's final problem, it is really hard ! If you could solve this problem during the competition, you will be reward in the ACM_DIY gathering. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line is one integer T indicates the number of the test cases. (T &lt;=500000)<br><br>Then for every case, three integers n k and p . (0 &lt;= n &lt;= 10^9,0 &lt;= k &lt;= 10^4, 1 &lt;= p &lt;= 10^8)</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Output one line.<br><br>First output ¡°Case #idx: ¡±, here idx is the case number count from 1.Then output remainder of the answer after divided by p.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">10 
1 10000 100000000 
2 3 10000 
3 97 98 
4 2 10 
5 1 29 
1234 5678 100000000 
3344 5566 77889900 
10000 10000 100000000 
1111 10000 90000000 
999 876 10000000</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case #1: 1 
Case #2: 2 
Case #3: 3 
Case #4: 4 
Case #5: 5 
Case #6: 17835789 
Case #7: 5381861 
Case #8: 71647609 
Case #9: 43710337
Case #10: 9102595</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>AekdyCoin</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Multi-University Training Contest 14 - Host by FZU&source=1&searchmode=source'> 2011 Multi-University Training Contest 14 - Host by FZU </a> </div> <div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3978'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3978'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3978">Discuss</a> | <a href='note/note.php?pid=3978'>Note</a><br></td></tr></div></body></html>