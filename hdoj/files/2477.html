<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2477</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Crop circles</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/6000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 174&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 27<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Is there really a monster living in Loch Ness? <br>Did the lost city of Atlantis ever exist? <br>Are UFOs tricks of the light, or actually vehicles from outer space? <br>Who is responsible for the strange patterns called crop circles¡ª¡ªclever hoaxers or alien beings? <br><br>As we can see, there are so many mysterious places, creatures and events in the world which puzzled people for centuries. In this problem, we won¡¯t go through all that puzzles. Which we are interested in is this one -- crop circles.<br><img src=../../data/images/C165-1004-1.jpg><br>You have probably seen pictures of crop circles. (i.e. see above) They are circular patterns which mysteriously appear in fields of crop, such as wheat and barley. For research, we model these patterns as N circles in the plane and number them with 1, 2, ¡­, N. Each of them has its center (Xi, Yi), radius Ri and an importance value Vi which is evaluated by the scientists.<br><br>After our observation, we found that there aren¡¯t any two circles touch each other in the crop circles. But it¡¯s possible that a circle is completely within another one. When we are in a certain circle, we should pass through its borderline once in order to get out from it. <br><br>For two distinct circles A and B, if one can go to B from A without passing through more than K borderlines, we say that A and B are connected. Here comes the problem: For all connected cycle pairs (A, B), what¡¯s the maximum difference of the importance value between them? The difference of the importance value between A and B can be defined as |VA ¨C VB|.<br>For example, look at the picture below. For K = 3, the optimal solution is to select the circle 1 and 3 which make the difference of importance value 220. And there are 3 borderlines between circle 1 and 3.<br>|V5 ¨C V1| = 300, which is larger than 220, but circle 5 and circle 1 are not connected. There¡¯re 4 borderlines between them, so we won¡¯t consider these kinds of pairs.<br><img src=../../data/images/C165-1004-2.jpg></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of input gives the number of cases T &lt;= 20. T test cases follow.<br>&nbsp;&nbsp;&nbsp;&nbsp;The first line of each case contains two integers N, K as described above. (1 &lt; N &lt; 50001, 1 &lt; K &lt; 101).<br>Next follow N lines, each contains four integers Xi, Yi, Ri, Vi, separated by spaces. The i-th line specifying the information of the i-th circle, where (Xi, Yi) are the coordinates of the center, Ri specifies the radius and Vi is the importance value. <br>(0 &lt; Ri &lt;= 2 * 10^8, -10^9 &lt; Xi, Yi, Vi &lt; 10^9)<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case you should output a single line containing &quot;Case X: Y&quot; (quotes for clarity) where X is the number of the test case (starting at 1) and Y is the maximum difference of importance value between two connected circles.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
5 3
10 10 1 -200
0 0 8 10
-2 2 2 20
3 -3 3 2
3 -3 1 100
3 2
-200 0 1 0
0 0 100 2
200 0 1 10</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 220
Case 2: 10</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 Asia Regional Chengdu&source=1&searchmode=source'> 2008 Asia Regional Chengdu </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2477'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2477'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2477">Discuss</a> | <a href='note/note.php?pid=2477'>Note</a><br></td></tr></div></body></html>