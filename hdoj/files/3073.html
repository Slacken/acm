<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3073</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Mars Life Tree</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 11&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 8<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>20XX, the lives, or fossils, more exactly, on the Mars, which is founded on a totally different life type to the Earth one are found by human beings. MLT, or Mars Life Tree, thought to be the breeder of all lives on the Mars is discovered as a fossil too, is proved there used to have extremely complex types of life.<br>There is an extremely huge MLT under the surface of the Mars, is not a real tree, but variety of carbon-based protein balls(called ¡°node¡±) connected by neuron links(called ¡°edge¡±), formed a tree like structure, which is peer-to-peer reachable and non-circled. However, scientist discovered that the MLT is able to grow and mutate from basically two nodes with one edge. The mutation refers that a node is able to mutate to another kind of node and, costs some energy. And the growing means that one node can reach out a new edge and grows a new node at the other end of the edge, of course spend energy. Luckily, the energy costs of every kind of mutation and growing are measured and calculated.<br>Since scientists found out that different shape of MLT may give a birth to different kinds of lives, they believe that the earliest two node, called roots, directly connect to an organ like a lair to bear lives, which is air-slaked and become untraceable in the fossil.<br>Assuming the MLT grows obeying the rule of costing least energy, your mission is find out the roots in the fossil, point out the initial status of these two nodes, and calculate the total energy may cost during the evolvement.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There may be multiple test cases.<br>There are two integers n (n&lt;=1000) and m (m&lt;=10) in the first line means the counts of nodes of the MLT, and counts of kinds of nodes.<br>There are n integers Ki (1&lt;=Ki&lt;=m) in the second line, figure out that the ith node is one of kind Ki.<br>Then followed two integers S1, S2, (1&lt;=S1, S2&lt;=m), shows the type of the two nodes at the beginning.<br>A m*m matrix U followed, for every element Uij (Uij&lt;100) in row i column j, refers the mutate energy cost from type i to type j.<br>Then there are m numbers P1 ¡­ Pm (Pi&lt;100), Pi refers the energy cost of reaching out a new edge and node end by type i.<br>Then n-1 lines follows, two integers in each line x, y, (1&lt;=x, y&lt;=n, x¡Ùy) means that node i and j are connected by a edge.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case:<br>One integer in the first line refers the link ID of the roots.<br>Second line contains one integer refers the minimal total cost growing the MLT.<br>Then a blank line followed.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 3
1 2 3
1 1
0 1 3
1 0 1
3 1 0
1 1 3
2 3
1 2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Multi-University Training Contest 17 - Host by NUDT&source=1&searchmode=source'> 2009 Multi-University Training Contest 17 - Host by NUDT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3073'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3073'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3073">Discuss</a> | <a href='note/note.php?pid=3073'>Note</a><br></td></tr></div></body></html>