<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 1486</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Dihedral groups</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 44&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 7<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Consider n points on a unit circle with numbers k = 0, 1, ..., n-1. Initially point k makes an angle of 360 ¡¤ k / n degrees to the x-axis, measured in counter-clockwise direction. We are going to perform two different kind of operations on that set of points:<br><br><li>rotation by 360 / n degrees in clockwise direction</li><br><li>reflection with respect to the x-axis</li><br><br>The following picture shows an example of these operations:<br><br><center><img src=/data/images/1486-1.png></center><br><br>Given a sequence of operations, we are interested in the shortest sequence of operations which gives the same result, i.e., the position of every single point is the same after performing either of those sequences of operations. <br><br>The sequence is given as a string consisting of the characters 'r' and 'm' which represent clockwise rotation and reflection respectively (&quot;to the right&quot; and &quot;mirror&quot;). Multiple consecutive occurrences of the same character are collected into the representation &lt;character&gt;&lt;number&gt;, and for convenience this will also be done for single occurrences. So &quot;rrmrrrrrrrrrrrr&quot; will be abbreviated to &quot;r2 m1 r12&quot;. The representations of different operations are always separated by a single space.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input file consists of several test cases. Each test case starts with a line containing n (3 ¡Ü n ¡Ü 10^8), the number of points. The second line of each test case consists of an abbreviated sequence of operations as described above. All numbers will be positive and less than 10^8. There will be no empty line in the input file, and no line will contain more than 100000 characters. The last test case is followed by a line containing 0.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case print one line containing the abbreviated format of the sequence with the minimum number of operations which results in the same configuration of points as the input sequence. In case of multiple optimal solutions, print any solution. Note that the second line of the sample output is a blank line.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4
r2
100
m1 r100 m1
54
r218 m3 r1
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">r2

r1 m1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2006/2007 ACM-ICPC University of Ulm Local Contest&source=1&searchmode=source'> 2006/2007 ACM-ICPC University of Ulm Local Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>JGShining</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=1486'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=1486'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=1486">Discuss</a> | <a href='note/note.php?pid=1486'>Note</a><br></td></tr></div></body></html>