<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 2430</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Beans</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 600&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 151<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mr. Pote's shop sells beans now. He has N bags of beans in his warehouse, and he has numbered them with 1, 2, бн, N according to their expired dates. The i-th bag contains Wi units of beans. For selling at retail makes only a little profit, Mr. Pote want to pack beans in small packets with certain size and sell them in packets. Here comes his packing way:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suppose the size of the packet is P units. Firstly, Mr. Pote selects some bags (at least one) of beans with consecutive number in his warehouse. Then he takes out the beans from all selected bags, and puts them together on the desktop. To pack the beans, he take P units of beans from desktop and fill in a new packet each time, until the beans left are less than P units. Finally the beans left on the desktop are eaten by a lucky dog.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mr. Pote doesn't want the dog eat too many beans, so he prefers to solutions that resulting no more than K units of beans eaten by the dog. Moreover, he also wants to pack as many packets as possible. Could you tell him how many packets he can pack at most without breaking his preference?<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On the first line of input, there is a single positive integer T &lt;= 20 specifying the number of test cases to follow. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Each test case contains two lines. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;There are three integers in the first line, N, P, K as described above. (0 &lt; N, P &lt; 1000001, 0 &lt;= K &lt; P)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next follow a line with N integers W1, W2, ..., WN. The i-th integers describes the amount of beans in the bags numbered i. (0 &lt;= Wi &lt; 32768)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numbers are separated by spaces.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For each test case you should output a single line containing &quot;Case X: Y&quot; (quotes for clarity) where X is the number of the test case (starting at 1) and Y is the maximum number of packets that Mr. Pote can pack following his way. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In case there's no solution avoiding the dog eats more than K units of beans, Y should be equal to -1.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
10 20 10
0 3 1 8 19 39 2 9 1 8
3 100 10
32 34 23
1 5 3
1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 4
Case 2: -1
Case 3: 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 Asia Chengdu Regional Contest Online&source=1&searchmode=source'> 2008 Asia Chengdu Regional Contest Online </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2430'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2430'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2430">Discuss</a> | <a href='note/note.php?pid=2430'>Note</a><br></td></tr></div></body></html>