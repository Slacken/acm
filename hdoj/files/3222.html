<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3222</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>Compressed String</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 107&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 31<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Dealing with super long character strings is Chris¡¯s daily work. Unfortunately, the strings are so long that even the fastest computer in the world cannot work with them.<br><br>Chris does her work in a smart way by compressing the strings into shorter expressions. She does her compression for each string in the following way:<br><br>a) Find a consecutive repeated substring of the original string, e.g. ¡°ab¡± in ¡°cabababd¡±.<br><br>b) Replace the repeating part with the bracketed repetend, followed by the times the repetend appears in the original string. e.g. Write ¡°cabababd¡± as ¡°c[ab]3d¡±. Note she can also write it as ¡°c[ab]1ababd¡± or ¡°ca[ba]2bd¡± and so on, although these string are not compressed as well as the first one is.<br><br>c) Repeat a) and b) several times until the string is short enough.<br><br>Chris does her compression quite well. But as you know, the work is boring and a waste of time. Chris has written a computer program to help her do the boring work. Unfortunately, there is something wrong with the program; it often outputs an incorrect result. To help her debug the program, you are ordered to write a debugger which can compare Chris¡¯s standard compressed string against the string compressed by the program.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases.<br>The first line of the input contains an integer T, meaning the number of the test cases.<br><br>For each test case, there are two lines of character strings which the first one is Chris¡¯s standard compressed string and the second one is the program¡¯s compressed string. Both string contains only lowercase letters (a-z), square brackets ([]) and numbers (0-9). The brackets must be followed with an integer indicating the times the string in the brackets repeat, note that the repeat time can be zero. The brackets can be nested.<br>You can assume all the compressed strings in the input are no longer than 20.<br>See further details in the input sample.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output case number first. And then if the two uncompressed strings are the same, output ¡°YES¡± in a single line; otherwise, output ¡°NO¡± followed by the first position where the uncompressed strings differ.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5
a[a]12
[[a]3]4a
[z]12
zzzzzzzzz
[a[ba]2b]12
[ab]36
[a]123123123[icpc]2
[[a]123]1001001inter
aismoreeasierthanc
gismuchharderthanj</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case #1: YES
Case #2: NO 10
Case #3: YES
Case #4: NO 123123125
Case #5: NO 1
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
For sample test case 3, the first string ¡°[a[ba]2b]12¡± can be written as ¡°[ababab]12¡±, then ¡°[[ab]3]12¡±, finally we get ¡°[ab]36¡±.

The numbers in this task may be very large and cannot be stored in a 32 bit integer.
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Asia Shanghai Regional Contest Host by DHU&source=1&searchmode=source'> 2009 Asia Shanghai Regional Contest Host by DHU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhuweicong</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3222'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3222'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3222">Discuss</a> | <a href='note/note.php?pid=3222'>Note</a><br></td></tr></div></body></html>