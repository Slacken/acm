<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3435</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>A new Graph Game</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 8000/4000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 651&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 309<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>An undirected graph is a graph in which the nodes are connected by undirected arcs. An undirected arc is an edge that has no arrow. Both ends of an undirected arc are equivalent--there is no head or tail. Therefore, we represent an edge in an undirected graph as a set rather than an ordered pair.<br>Now given an undirected graph, you could delete any number of edges as you wish. Then you will get one or more connected sub graph from the original one (Any of them should have more than one vertex).<br>You goal is to make all the connected sub graphs exist the Hamiltonian circuit after the delete operation. What¡¯s more, you want to know the minimum sum of all the weight of the edges on the ¡°Hamiltonian circuit¡± of all the connected sub graphs (Only one ¡°Hamiltonian circuit¡± will be calculated in one connected sub graph! That is to say if there exist more than one ¡°Hamiltonian circuit¡± in one connected sub graph, you could only choose the one in which the sum of weight of these edges is minimum).<br>&nbsp;&nbsp;For example, we may get two possible sums:<br><center><img src=../../data/images/3435-1.jpg></center> <br>(1)&nbsp;&nbsp;7 + 10 + 5 = 22<br>(2)&nbsp;&nbsp;7 + 10 + 2 = 19<br>(There are two ¡°Hamiltonian circuit¡± in this graph!)</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>In the first line there is an integer T, indicates the number of test cases. (T &lt;= 20)<br>In each case, the first line contains two integers n and m, indicates the number of vertices and the number of edges. (1 &lt;= n &lt;=1000, 0 &lt;= m &lt;= 10000)<br>Then m lines, each line contains three integers a,b,c ,indicates that there is one edge between a and b, and the weight of it is c . (1 &lt;= a,b &lt;= n, a is not equal to b in any way, 1 &lt;= c &lt;= 10000)<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Output ¡°Case %d: ¡°first where d is the case number counted from one. Then output ¡°NO¡± if there is no way to get some connected sub graphs that any of them exists the Hamiltonian circuit after the delete operation. Otherwise, output the minimum sum of weight you may get if you delete the edges in the optimal strategy.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3

3 4
1 2 5
2 1 2
2 3 10
3 1 7 

3 2
1 2 3
1 2 4

2 2
1 2 3
1 2 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 19
Case 2: NO
Case 3: 6
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>In Case 1:
You could delete edge between 1 and 2 whose weight is 5. 

In Case 2:
It¡¯s impossible to get some connected sub graphs that any of them exists the Hamiltonian circuit after the delete operation.</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>AekdyCoin</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨1£©¡ª¡ªHost by FZU&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨1£©¡ª¡ªHost by FZU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhouzeyong</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3435'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3435'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3435">Discuss</a> | <a href='note/note.php?pid=3435'>Note</a><br></td></tr></div></body></html>