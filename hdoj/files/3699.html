<!DOCTYPE html><html><head><link rel="stylesheet" type=text/css href="../style.css" /><title>Problem 3699</title></head><body><div id="content"><tr><td align=center><h1 style='color:#1A5CC8'>A hard Aoshu Problem</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 62768/32768 K (Java/Others)<br>Total Submission(s): 264&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 134<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Math Olympiad is called ¡°Aoshu¡± in China. Aoshu is very popular in elementary schools. Nowadays, Aoshu is getting more and more difficult. Here is a classic Aoshu problem:<br><br><br>ABBDE __ ABCCC = BDBDE<br><br>In the equation above, a letter stands for a digit(0 ¨C 9), and different letters stands for different digits. You can fill the blank with ¡®+¡¯, ¡®-¡® , ¡®¡Á¡¯ or ¡®¡Â¡¯. <br><br>How to make the equation right? Here is a solution:<br><br><br>12245 + 12000 = 24245<br><br>In that solution, A = 1, B = 2, C = 0, D = 4, E = 5, and ¡®+¡¯ is filled in the blank.<br><br>When I was a kid, finding a solution is OK. But now, my daughter¡¯s teacher tells her to find all solutions. That¡¯s terrible. I doubt whether her teacher really knows how many solutions are there. So please write a program for me to solve this kind of problems.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of the input is an integer T( T &lt;= 20) indicating the number of test cases.<br><br>Each test case is a line which is in the format below:<br><br><br>s1 s2 s3 <br><br>s1, s2 and s3 are all strings which are made up of capital letters. Those capital letters only include ¡®A¡¯,¡¯B¡¯,¡¯C¡¯,¡¯D¡¯ and ¡®E¡¯, so forget about ¡®F¡¯ to ¡®Z¡¯. The length of s1,s2 or s3 is no more than 8.<br><br>When you put a ¡®=¡¯ between s2 and s3, and put a operator( ¡®+¡¯,¡¯-¡®, ¡®¡Á¡¯ or ¡®¡Â¡¯.) between s1 and s2, and replace every capital letter with a digit, you get a equation. <br><br>You should figure out the number of solutions making the equation right.<br><br>Please note that same letters must be replaced by same digits, and different letters must be replaced by different digits. If a number in the equation is more than one digit, it must not have leading zero.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print an integer in a line. It represents the number of solutions.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
A A A
BCD BCD B</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5
72</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Asia Fuzhou Regional Contest&source=1&searchmode=source'> 2010 Asia Fuzhou Regional Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>chenyongfu</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3699'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3699'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3699">Discuss</a> | <a href='note/note.php?pid=3699'>Note</a><br></td></tr></div></body></html>