<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2974</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Counting heaps</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/5000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 192&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 43<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>We are given a rooted tree of n vertices. The vertices are to be labeled with numbers 1,2,..., n so that each label is unique and the heap condition holds, i.e. the label of any vertex is less than the label of its parent. How many such labellings exist? Since this number may be quite large, calculate only its<br>remainder modulo m.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input contains several tree descriptions. The first line contains the number of input trees t (t &lt;=250).<br><br>Each tree description begins with a line containing the size of the tree n (1 &lt;= n &lt;= 500000) and an integer m (2 &lt;= m &lt;= 10^9). n - 1 lines follow, i-th of which contains p(i + 1), the number of the parent of the i + 1-th vertex (1 &lt;= p(i + 1) &lt;= i). Vertex number 1 will be the root in each tree, so its parent will not be given. Total size of the input will not exceed 50MB.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each tree output the number of its valid labellings modulo given m.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4
3 1000000
1
1
4 1000000
1
1
1
5 1000000
1
2
3
4
5 1000000
1
1
3
3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
6
1
8


<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
<center><img src='../../../data/images/con181-1010-1.JPG'></center>
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=Central European Programming Contest 2008&source=1&searchmode=source'> Central European Programming Contest 2008 </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2974'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2974'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2974">Discuss</a> | <a href='note/note.php?pid=2974'>Note</a><br></td></tr></div></body></html>