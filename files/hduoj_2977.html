<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2977</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Color Squares</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 309&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 103<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>You have a 3 * 3  board of color squares. Each square is either empty or has a block in it. Initially, all the squares are empty. There are four kinds of blocks: blue (B), red (R), green (G) and yellow (Y). Each of these block scores  wb, wr, wg  and wy , respectively (blocks of the same color always have the same score). We assume that wb&lt;=wr&lt;=wg&lt;=wy .<br><br><center><img src=../../../data/images/con216-1003-1.JPG></center><br>In each step, you can place a new block in a square. If that square already has a block in it, take it out first (taking it out does not count as a step). You can do this as many times as you like (you're given enough blocks for each color), as long as you follow these rules:<br><br><br>    Rule 1: You can always place a blue block. <br>    Rule 2: You can place a red block if and only if it's surrounded by at least one blue block. <br>    Rule 3: You can place a green block if and only if it's surrounded by at least one blue and one red block. <br>    Rule 4: You can place a yellow block if and only if it's surrounded by at least one blue, one red and one green block <br><br><br>Every square is surrounded by squares that share one edge with it, so each of four corner squares is surrounded by exactly two squares, each of four squares on the edge (but not at corners) is surrounded by exactly three squares, and the center square is surrounded by exactly four squares.<br><br>Write a program to find the minimal number of steps needed to get a score of at least w . The total score is the sum of individual scores of each block on the current board, regardless of what blocks you've thrown away. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input contains several test cases. Each case contains five positive integer, wb, wr, wg, wy, w  (1&lt;=wb&lt;=wr&lt;=wg&lt;=wy¡Ü100, 0&lt;=w&lt;=1000)  in a single line. The last test case is followed by a single zero, which should not be processed. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the case number and the minimum number of steps. If it is impossible, output ``Impossible&quot;. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1 1 1 1 3 
1 2 4 8 21 
1 1 1 100 500 
7 20 53 94 395
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 3 
Case 2: 7 
Case 3: Impossible 
Case 4: 11</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2007 Asia Regional Beijing &source=1&searchmode=source'> 2007 Asia Regional Beijing  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>gaojie</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2977'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2977'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2977">Discuss</a> | <a href='note/note.php?pid=2977'>Note</a><br></td></tr></div></body></html>