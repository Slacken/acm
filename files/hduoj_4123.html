<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4123</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Bob¡¯s Race</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 394&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 118<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Bob wants to hold a race to encourage people to do sports. He has got trouble in choosing the route. There are N houses and N - 1 roads in his village. Each road connects two houses, and all houses are connected together. To make the race more interesting, he requires that every participant must start from a different house and run AS FAR AS POSSIBLE without passing a road more than once. The distance difference between the one who runs the longest distance and the one who runs the shortest distance is called ¡°race difference¡± by Bob. Bob does not want the ¡°race difference¡±to be more than Q. The houses are numbered from 1 to N. Bob wants that the No. of all starting house must be consecutive. He is now asking you for help. He wants to know the maximum number of starting houses he can choose, by other words, the maximum number of people who can take part in his race.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several test cases.<br>The first line of each test case contains two integers N and M. N is the number of houses, M is the number of queries.<br>The following N-1 lines, each contains three integers, x, y and z, indicating that there is a road of length z connecting house x and house y.<br>The following M lines are the queries. Each line contains an integer Q, asking that at most how many people can take part in Bob¡¯s race according to the above mentioned rules and under the condition that the¡°race difference¡±is no more than Q. <br><br>The input ends with N = 0 and M = 0.<br><br>(N&lt;=50000 M&lt;=500 1&lt;=x,y&lt;=N 0&lt;=z&lt;=5000 Q&lt;=10000000)<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, you should output the answer in a line for each query.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5 5
1 2 3
2 3 4
4 5 3
3 4 2
1
2
3
4
5
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
3
3
3
5</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Asia Fuzhou Regional Contest &source=1&searchmode=source'> 2011 Asia Fuzhou Regional Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4123'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4123'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4123">Discuss</a> | <a href='note/note.php?pid=4123'>Note</a><br></td></tr></div></body></html>