<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3247</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Resource Archiver</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 20000/10000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 100000/100000 K (Java/Others)<br>Total Submission(s): 690&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 178<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Great! Your new software is almost finished! The only thing left to do is archiving all your n resource files into a big one.<br>Wait a minute¡­ you realized that it isn¡¯t as easy as you thought. Think about the virus killers. They¡¯ll find your software suspicious, if your software contains one of the m predefined virus codes. You absolutely don¡¯t want this to happen.<br>Technically, resource files and virus codes are merely 01 strings. You¡¯ve already convinced yourself that none of the resource strings contain a virus code, but if you make the archive arbitrarily, virus codes can still be found somewhere.<br>Here comes your task (formally): design a 01 string that contains all your resources (their occurrences can overlap), but none of the virus codes. To make your software smaller in size, the string should be as short as possible.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There will be at most 10 test cases, each begins with two integers in a single line: n and m (2 &lt;= n &lt;= 10, 1 &lt;= m &lt;= 1000). The next n lines contain the resources, one in each line. The next m lines contain the virus codes, one in each line. The resources and virus codes are all non-empty 01 strings without spaces inside. Each resource is at most 1000 characters long. The total length of all virus codes is at most 50000. The input ends with n = m = 0.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the length of shortest string.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 2
1110
0111
101
1001
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 ¡°NIT Cup¡± National Invitational Contest&source=1&searchmode=source'> 2009 ¡°NIT Cup¡± National Invitational Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>wujianhua</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3247'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3247'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3247">Discuss</a> | <a href='note/note.php?pid=3247'>Note</a><br></td></tr></div></body></html>