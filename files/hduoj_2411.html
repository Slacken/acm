<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2411</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Calculating Taxi Fare</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 32&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 6<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The rules for calculating the taxi fares are quite complex. Many factors are to be considered in computing the taxi fares, including the length of the trip, the time of the day, the speed, etc. Every morning Bianca Bennett uses taxi to get to her office, she thinks if taximeters are programmed correctly. One day, she decided to write a program to calculate the taxi fares to check this.<br><br>Imagine a taxi passes through a sequence of streets S<sub>1</sub>, S<sub>2</sub>, ..., S<sub>n</sub> in order. The length of S<sub>i</sub> is L<sub>i</sub> and it is assumed that the taxi travels in a constant speed and it takes M<sub>i</sub> minutes to travel one kilometer in S<sub>i</sub>. To make it simple, assume the passenger gets in at the start of a street S<sub>i</sub> and gets out at the end of the destination street S<sub>j</sub> (i.e., he does not get in or out in the middle of a street). The passenger is charged for each kilometer of the trip. The first ten kilometers of the trip cost 1000 Rials each. The next 20 kilometers (from 11 to 30) cost 250 Rials each. After that, each kilometer costs 100 Rials.<br><br>During the night, the fare is increased by 20%. The rule is that for each kilometer, if the taxi travels at least one minute during the time interval [12 AM, 6 AM], that kilometer will cost 20% more. Since driving in a heavy traffic costs more, if the average speed of the taxi is less than 30 km/h during the whole trip, the fare is increased by 10%.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input consists of multiple test cases. The first part of each test case is the sequence of streets the taxi travels. This comes in several lines, each describing one street in the form of <i>street-name length min</i>. <i>street-name</i> is a unique string of at most 20 letters and digits with no blank in it, and <i>length</i> and <i>min</i> are two positive integer numbers which are L<sub>i</sub>; (measured in kilometers, at most 200) and M<sub>i</sub> (measured in minutes) respectively. Each street is visited once by the taxi. The first part of the test case is terminated by a line containing a single $ character. The second part of the test case contains a single line of the form <i>source-street dest-street time</i>. The first two items are the names of the source and the destination streets respectively. The third item is the time the passenger gets in which is in standard 24-hours format (HH:MM). There is a line containing a single # character at the end of each test case. You may assume that the source and the destination streets belong to the input sequence of streets and the destination street does not come before the source street. The last line of the input contains two dash characters as shown in the sample input.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a line containing the fare of the passenger's trip.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Khayyam 10 35
15thKhordad 50 15 
Pamenar 15 40
$
Khayyam Pamenar 07:15
#
Jenah 10 40
Nouri 50 70
Hemmat 30 25
Chamran 80 80
ValieAsr 30 20
$
Nouri ValieAsr 23:30
#
--</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">21758
36432</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2006 Asia Regional Tehran&source=1&searchmode=source'> 2006 Asia Regional Tehran </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2411'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2411'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2411">Discuss</a> | <a href='note/note.php?pid=2411'>Note</a><br></td></tr></div></body></html>