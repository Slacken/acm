<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3556</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Continued Fraction</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 131072/65536 K (Java/Others)<br>Total Submission(s): 250&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 65<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Dumbear loves numbers very much.<br>One day Dumbear found that each number can be expressed as a continued fraction. See below.<br><img src=../../data/images/C300-1003-1.jpg><br>Formally, we say a number k can be expressed as a continued faction if<br><img src=../../data/images/C300-1003-2.jpg><br>where a<sub>0</sub>, a<sub>1</sub>, ¡­, a<sub>n</sub> are positive integers except that a<sub>0</sub> maybe be 0 and a<sub>n</sub> cannot be 1.<br>Dumbear also found a sequence which looks like the Farey sequence. Initially the sequence<img src=../../data/images/C300-1003-3.jpg>and if we insert an element<img src=../../data/images/C300-1003-4.jpg>between all the two adjacent element<img src=../../data/images/C300-1003-5.jpg>,<img src=../../data/images/C300-1003-6.jpg>in D<sub>i</sub>, then we get a sequence D<sub>i+1</sub>. So you can see<img src=../../data/images/C300-1003-7.jpg>and<img src=../../data/images/C300-1003-8.jpg>Assume initially you are on the element<img src=../../data/images/C300-1003-11.jpg>in D<sub>0</sub>, and if now you are on the element k in D<sub>i</sub>, then if you go left(¡®L¡¯)(or right(¡®R¡¯)) you will be on the left(or right) element of k in D<sub>i+1</sub>. So a sequence composed of ¡®L¡¯ and ¡®R¡¯ denotes a number. Such as ¡®RL¡¯ denotes the number <img src=../../data/images/C300-1003-9.jpg><br><br>Now give you a sequence composed of ¡®L¡¯ and ¡®R¡¯, you should print the continued fraction form of the number. You should use ¡®-¡® to show the vinculum(the horizontal line), you should print one space both in front and back of ¡®+¡¯, and all parts up or down the vinculum should be right aligned. You should not print unnecessary space, ¡®-¡® or other character. See details in sample.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several test cases in the input.<br>For each test case, there is a single line contains only a sequence composed of ¡®L¡¯ and ¡®R¡¯. The length of the sequence will not exceed 10000.<br>The input terminates by end of file marker.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output the continued fraction form of the number which the input sequence denotes. The total amount of output will not exceed 4MB.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">LR
RL</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">        1 
0 + ----- 
        1
    1 + -
        2
    1
1 + -
    2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>Dumbear@WHU</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨12£©¡ª¡ªHost by WHU&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨12£©¡ª¡ªHost by WHU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>zhouzeyong</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3556'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3556'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3556">Discuss</a> | <a href='note/note.php?pid=3556'>Note</a><br></td></tr></div></body></html>