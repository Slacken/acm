<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2429</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Word Game</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 797&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 200<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It's a game with two players. Given a dictionary of words, a word S chosen from the dictionary to start with, and a word T also chosen from the dictionary as the winning word, which will be described below, the two players take turns to choose a word from the dictionary, satisfying that the first letter of the chosen word is the same as the last letter of previous word. Each word could be chosen more than once.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suppose they play exactly n rounds. At the last round, if the player (the first one if n is odd, the second one otherwise) chooses the winning word T, he wins. To your surprise that, the two players are not so clever that they choose words randomly.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here comes the question. How many different ways will the first player win if they play no more than N rounds, among all the possible ways satisfying all the conditions above?<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An integer C, indicates the number of test cases.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Then comes C blocks, formatted like this:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An integer M, indicates the number of words in the dictionary, M &lt;= 30.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M string consisting of only lowercase letters, represent the words in the dictionary. The length of each word is no more than 10. There are no duplicated words.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String S, the word to start with.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String T, the winning word.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A positive integer N, indicates the maximum number of rounds to play. N fits in a signed 32-bit integer.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For each test case, print a line with an integer W, indicating how many possible ways the first player wins.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output the answer modulo 10001.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
3
abc
cac
cde
abc
cde
3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2008 Asia Chengdu Regional Contest Online&source=1&searchmode=source'> 2008 Asia Chengdu Regional Contest Online </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2429'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2429'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2429">Discuss</a> | <a href='note/note.php?pid=2429'>Note</a><br></td></tr></div></body></html>