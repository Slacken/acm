<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 1385</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Minimum Transport Cost</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 3750&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 954<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>These are N cities in Spring country. Between each pair of cities there may be one transportation track or none. Now there is some cargo that should be delivered from one city to another. The transportation fee consists of two parts: <br>The cost of the transportation on the path between these cities, and<br><br>a certain tax which will be charged whenever any cargo passing through one city, except for the source and the destination cities.<br><br>You must write a program to find the route which has the minimum cost.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>First is N, number of cities. N = 0 indicates the end of input.<br><br>The data of path cost, city tax, source and destination cities are given in the input, which is of the form:<br><br>a11 a12 ... a1N<br>a21 a22 ... a2N<br>...............<br>aN1 aN2 ... aNN<br>b1  b2  ... bN<br><br>c d<br>e f<br>...<br>g h<br><br>where aij is the transport cost from city i to city j, aij = -1 indicates there is no direct path between city i and city j. bi represents the tax of passing through city i. And the cargo is to be delivered from city c to city d, city e to city f, ..., and g = h = -1. You must output the sequence of cities passed by and the total cost which is of the form:<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>From c to d :<br>Path: c--&gt;c1--&gt;......--&gt;ck--&gt;d<br>Total cost : ......<br>......<br><br>From e to f :<br>Path: e--&gt;e1--&gt;..........--&gt;ek--&gt;f<br>Total cost : ......<br><br>Note: if there are more minimal paths, output the lexically smallest one. Print a blank line after each test case.<br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5
0 3 22 -1 4
3 0 5 -1 -1
22 5 0 9 20
-1 -1 9 0 4
4 -1 20 4 0
5 17 8 3 1
1 3
3 5
2 4
-1 -1
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">From 1 to 3 :
Path: 1-->5-->4-->3
Total cost : 21

From 3 to 5 :
Path: 3-->4-->5
Total cost : 16

From 2 to 4 :
Path: 2-->1-->5-->4
Total cost : 17</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=Asia 1996, Shanghai (Mainland China)&source=1&searchmode=source'> Asia 1996, Shanghai (Mainland China) </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>Eddy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=1385'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=1385'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=1385">Discuss</a> | <a href='note/note.php?pid=1385'>Note</a><br></td></tr></div></body></html>