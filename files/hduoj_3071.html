<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3071</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Gcd & Lcm game</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 477&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 75<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>&nbsp;&nbsp;Tired of playing too much computer games, alpc23 is planning to play a game on numbers. Because plus and subtraction is too easy for this gay, he wants to do some gcd and lcm operations in a number sequence. After playing it a few times, he has found it is also too boring. So he plan to do a more challenge job: he wants to change several numbers in this sequence and also work out the gcd or lcm of all the number in a subsequence of the whole sequence.<br>&nbsp;&nbsp;To be a friend of this gay, you have been invented by him to play this interesting game with him. Of course, you need to work out the answers faster than him to get a free lunch, He he¡­<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases.<br>For each test case.The first line is the length of sequence n, and the number of queries q. (1&lt;=n, q&lt;=100000) The second line has n numbers, they are the initial n numbers of the sequence a1,a2, ¡­,an, <br>From the third line to the q+2 line are the description of the q operations. They are the one of the two forms:<br>L k1 k2 p; you need to work out the value after mod p of lcm of the subsequence from k1 to k2, inclusive. (1&lt;=k1&lt;=k2&lt;=n) <br>G k1 k2 p; you need to work out the value after mod p of gcd of the subsequence from k1 to k2, inclusive. (1&lt;=k1&lt;=k2&lt;=n) <br>C k v; the k-th number of the sequence has been changed to v.<br>You can assume that all the numbers before and after the replacement are positive and no larger than 100.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each of the first or second operation, you need to output the answer in each line.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">6 4
1 2 4 5 6 3
L 2 5 17
G 4 6 4
C 4 9
G 4 6 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">9
1
3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Multi-University Training Contest 17 - Host by NUDT&source=1&searchmode=source'> 2009 Multi-University Training Contest 17 - Host by NUDT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3071'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3071'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3071">Discuss</a> | <a href='note/note.php?pid=3071'>Note</a><br></td></tr></div></body></html>