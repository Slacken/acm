<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3236</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Gift Hunting</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 6000/3000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 678&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 226<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>After winning two coupons for the largest shopping mart in your city, you can't wait inviting your girlfriend for gift hunting. Having inspected hundreds of kinds of souvenirs, toys and cosmetics, you finally narrowed down the candidate list to only <i>n</i> gifts, numbered 1 to <i>n</i>. Each gift has a happiness value that measures how happy your girlfriend would be, if you get this gift for her. Some of them are special - you <b>must</b> get it for your girlfriend (note that whether a gift is special has nothing to do with its happiness value).<br><br>Coupon 1 can be used to buy gifts with total price not greater than <i>V</i>1 (RMB). Like most other coupons, you <b>can¡¯t</b> get any money back if the total price is strictly smaller than <i>V</i>1. Coupon 2 is almost the same, except that it¡¯s worth <i>V</i>2. Coupons should be used separately. That means you cannot combine them into a super-coupon that¡¯s worth <i>V</i>1+<i>V</i>2. You have to divide the gifts you choose into two part, one uses coupon 1, the other uses coupon 2.<br><br>It is your girlfriend's birthday today. According to the rules of the mart, she can take one (only one) gift for FREE! Here comes your challenge: how to make your girlfriend as happy as possible?</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There will be at most 20 test cases. Each case begins with 3 integers <i>V</i>1, <i>V</i>2 and <i>n</i> (1 &lt;= <i>V</i>1 &lt;= 500, 1 &lt;= <i>V</i>2 &lt;= 50, 1 &lt;= <i>n</i> &lt;= 300), the values of coupon 1 and coupon 2 respectively, and the number of candidate gifts. Each of the following <i>n</i> lines describes a gift with 3 integers: <i>P</i>, <i>H</i> and <i>S</i>, where <i>P</i> is the price, <i>H</i> is the happiness (1 &lt;= <i>P,H</i> &lt;= 1000), <i>S</i>=1 if and only if this is a special gift - you must buy it (or get it for free). Otherwise <i>S</i>=0. The last test case is followed by <i>V</i>1 = <i>V</i>2 = <i>n</i> = 0, which should not be processed.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, print the case number and the maximal total happiness of your girlfriend. If you can't finish the task, i.e. you are not able to buy all special gifts even with the 1-FREE bonus, the happiness is -1 (negative happiness means she's unhappy). Print a blank line after the output of each test case.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 2 4
3 10 1
2 10 0
5 100 0
5 80 0
3 2 4
3 10 1
2 10 0
5 100 0
5 80 1
0 0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 120

Case 2: 100</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Asia Wuhan Regional Contest Hosted by Wuhan University&source=1&searchmode=source'> 2009 Asia Wuhan Regional Contest Hosted by Wuhan University </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>chenrui</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3236'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3236'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3236">Discuss</a> | <a href='note/note.php?pid=3236'>Note</a><br></td></tr></div></body></html>