<!DOCTYPE html><html>
				<head><meta charset=utf-8 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 1162</title></head>
				<body><div id="content"><dl class="main-title-mod mb10">
            <dt class="title-hd">
                题目1162：I Wanna Go Home
            </dt>
            <dd class="title-bd">
            	                <div class="pl20 mb10 f14 topic-desc-mod">
                    <div class="topic-desc-hd">
                        <p style="width:140px;"><b>时间限制：</b>1 秒</p>
                        <p style="width:140px;"><b>内存限制：</b>32 兆</p>
                        <p style="width:100px;"><b>特殊判题：</b>否</p>
                        <p style="width:130px;"><b>提交：</b>29</p>
                        <p style="width:130px;"><b>解决：</b>19</p>
                    </div>
                   	<div class="topic-desc-bd">
                   	<dl>
                       <dt>
                           <b>题目描述：</b>
                       </dt>
                       <dd>
                           <p>&nbsp; &nbsp; The country is facing a terrible civil war----cities in the country are divided into two parts supporting different leaders. As a merchant, Mr. M does not pay attention to politics but he actually knows the severe situation, and your task is to help him reach home as soon as possible. <br />
&nbsp; &nbsp; &quot;For the sake of safety,&quot;, said Mr.M, &quot;your route should contain at most 1 road which connects two cities of different camp.&quot;<br />
&nbsp; &nbsp; Would you please tell Mr. M at least how long will it take to reach his sweet home?</p>
                       </dd>
                   	</dl>
                   	<dl>
                       <dt>
                           <b>输入：</b>
                       </dt>
                       <dd>
                           <p>&nbsp; &nbsp; The input contains multiple test cases.<br />
&nbsp; &nbsp; The first line of each case is an integer N (2&lt;=N&lt;=600), representing the number of cities in the country.<br />
&nbsp; &nbsp; The second line contains one integer M (0&lt;=M&lt;=10000), which is the number of roads.<br />
&nbsp; &nbsp; The following M lines are the information of the roads. Each line contains three integers A, B and T, which means the road between city A and city B will cost time T. T is in the range of [1,500].<br />
&nbsp; &nbsp; Next part contains N integers, which are either 1 or 2. The i-th integer shows the supporting leader of city i. <br />
&nbsp; &nbsp; To simplify the problem, we assume that Mr. M starts from city 1 and his target is city 2. City 1 always supports leader 1 while city 2 is at the same side of leader 2. <br />
&nbsp; &nbsp; Note that all roads are bidirectional and there is at most 1 road between two cities.<br />
Input is ended with a case of N=0.</p>
                       </dd>
                   	</dl>
                       <dl>
                       <dt>
                           <b>输出：</b>
                       </dt>
                       <dd>
                           <p>&nbsp; &nbsp; For each test case, output one integer representing the minimum time to reach home.<br />
&nbsp; &nbsp; If it is impossible to reach home according to Mr. M's demands, output -1 instead.</p>
                       </dd>
                   	</dl>
                   	<dl>
                       <dt>
                           <b>样例输入：</b>
                       </dt>
                       <dd>
                           <pre>2
1
1 2 100
1 2
3
3
1 2 100
1 3 40
2 3 50
1 2 1
5
5
3 1 200
5 3 150
2 5 160
4 3 170
4 2 170
1 2 2 2 1
0</pre>
                       </dd>
                   	</dl>
                   	<dl>
                       <dt>
                           <b>样例输出：</b>
                       </dt>
                       <dd>
                           <pre>100
90
540</pre>
                       </dd>
                   	</dl>
                   	                   				                  <dl>
			                       <dt>
			                           <b>来源：</b>
			                       </dt>
			                       <dd class="lBlue">
			                          <a href="problemset.php?search=2011年北京大学计算机研究生机试真题">
			                              <i class="txt-ul">2011年北京大学计算机研究生机试真题</i>
			                          </a>
			                       </dd>
			                  </dl>
	             				             			                       <dl>
	                       <dt>
	                           <b>答疑：</b>
	                       </dt>
	                       <dd class="lBlue">
	                           解题遇到问题?分享解题心得?讨论本题请访问：<a class="cBlue" href="http://t.jobdu.com/thread-7885-1-1.html" target="_blank">http://t.jobdu.com/thread-7885-1-1.html</a>
	                       </dd>
                       </dl>
                                       	</div>
                </div>
                            </dd>
		</dl></div></body></html>