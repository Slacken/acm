<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3683</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Gomoku</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 730&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 186<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>You are probably not familiar with the title, ¡°Gomoku¡±, but you must have played it a lot. Gomoku is an abstract strategy board game and is also called Five in a Row, or GoBang. It is traditionally played with go pieces (black and white stones) on a go board (19x19 intersections). Nowadays, standard chessboard of Gomoku has 15x15 intersections. Black plays first, and players alternate in placing a stone of their color on an empty intersection. The winner is the first player to get an unbroken row of five or more stones horizontally, vertically, or diagonally. <br><center><img src=../../data/images/3683-1.gif></center>  <br> For convenience, we coordinate the chessboard as illustrated above. The left-bottom intersection is (0,0). And the bottom horizontal edge is x-axis, while the left vertical line is y-axis. <br><br>I am a fan of this game, actually. However, I have to admit that I don¡¯t have a sharp mind. So I need a computer program to help me. What I want is quite simple. Given a chess layout, I want to know whether someone can win within 3 moves, assuming both players are clever enough. Take the picture above for example. There are 31 stones on it already, 16 black ones and 15 white ones. Then we know it is white turn. The white player must place a white stone at (5,8). Otherwise, the black player will win next turn. After that, however, the white player also gets a perfect situation that no matter how his opponent moves, he will win at the 3rd move. <br><br>So I want a program to do similar things for me. Given the number of stones and positions of them, the program should tell me whose turn it is, and what will happen within 3 moves.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input contains no more than 20 cases.<br>Each case contains n+1 lines which are formatted as follows.<br>n<br>x1 y1 c1<br>x2 y2 c2<br>......<br>xn yn cn<br>The first integer n indicates the number of all stones. n&lt;=222 which means players have enough space to place stones. Then n lines follow. Each line contains three integers: xi and yi and ci. xi and yi are coordinates of the stone, and ci means the color of the stone. If ci=0 the stone is white. If ci=1 the stone is black. It is guaranteed that 0&lt;=xi,yi&lt;=14, and ci=0 or 1. No two stones are placed at the same position. It is also guaranteed that there is no five in a row already, in the given cases.<br>The input is ended by n=0.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case:<br><br>First of all, the program should check whose turn next. Let¡¯s call the player who will move next ¡°Mr. Lucky¡±. Obviously, if the number of the black stone equals to the number of white, Mr. Lucky is the black player. If the number of the black stone    equals to one plus the numbers of white, Mr. Lucky is the white player. If it is not the first situation or the second, print ¡°Invalid.¡± <br><br>A valid chess layout leads to four situations below:<br><br>1)Mr. Lucky wins at the 1st move. In this situation, print :<br><br>Place TURN at (x,y) to win in 1 move.<br><br> ¡°TURN¡± must be replaced by ¡°black¡± or ¡°white¡± according to the situation and (x,y) is the position of the move. If there are different moves to win, choose the one where x is the smallest. If there are still different moves, choose the one where y is the smallest.<br><br>2)Mr. Lucky¡¯s opponent wins at the 2nd move. In this situation, print:<br><br>Lose in 2 moves.<br><br>3)Mr. Lucky wins at the 3rd move. If so, print:<br><br>Place TURN at (x,y) to win in 3 moves.<br><br>¡°TURN¡± should replaced by ¡°black¡± or ¡°white¡±, (x,y) is the position where the Mr. Lucky should place a stone at the 1st move. After he place a stone at (x,y), no matter what his opponent does, Mr. Lucky will win at the 3rd step. If there are multiple choices, do the same thing as described in situation 1. <br><br>4)Nobody wins within 3 moves. If so, print:<br><br>Cannot win in 3 moves.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">31
3 3 1
3 4 0
3 5 0
3 6 0
4 4 1
4 5 1
4 7 0
5 3 0
5 4 0
5 5 1
5 6 1
5 7 1
5 9 1
6 4 1
6 5 1
6 6 0
6 7 1
6 8 0
6 9 0
7 5 1
7 6 0
7 7 1
7 8 1
7 9 0
8 5 0
8 6 1
8 7 0
8 8 1
8 9 0
9 7 1
10 8 0
1
7 7 1
1
7 7 0
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Place white at (5,8) to win in 3 moves.
Cannot win in 3 moves.
Invalid.</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 Asia Hangzhou Regional Contest &source=1&searchmode=source'> 2010 Asia Hangzhou Regional Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy&amp;zhengfeng</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3683'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3683'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3683">Discuss</a> | <a href='note/note.php?pid=3683'>Note</a><br></td></tr></div></body></html>