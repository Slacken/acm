<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4204</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Walking the Plank</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 33&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 19<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>A bunch of pirates have successfully conquered a commercial vessel. The ship itself is too badly damaged, so the entire shipload needs to be transferred to the pirate ship.<br>The pirates have anchored a plank to both ships, which the pirates can use to go from one ship to the other, but it can only support one pirate at a time.<br>Each pirate executes the following routine:<br>1. Walk across the plank from the pirate ship to the commercial ship<br>2. Pick up an item from the cargo hold and return to the plank<br>3. Cross the plank back to the pirate ship with the item<br>4. Put the item in the cargo hold and return to the plank<br>Each of these four steps takes a given amount of time for each pirate. Every pirate will repeat these steps until the number of pirates on the commercial ship equals the number of items there (i.e. there's nothing more for the pirate to collect).<br>If a pirate gets to the plank and it's in use by another pirate, he will wait at his side of the plank. When the plank is vacated and there are pirates on both sides of the plank, the pirates on the side of the commercial vessel (carrying some item) will get to go first. At both sides of the plank, the pirates queue up, i.e. the first one to get there will be the first one to cross. Should two or more pirates arrive at the same side of the plank at the exact same time, the pirate who was slowest (i.e. the one who has taken the most time to and from the cargo hold on this ship) gets to go first.Can you determine how long it takes before the last pirate has crossed the plank with the last item?</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of the input contains a single number: the number of test cases to follow. Each test case has the following format:<br>1.One line with two integers N and P, satisfying 1 &lt;= N &lt;= 100,000 and 1 &lt;= P &lt;= 1,000: the number of items on the commercial vessel and the number of pirates, respectively.<br>2.P lines, each with 4 integers t1 through t4, satisfying 1 &lt;= ti &lt;= 1,000: the time in seconds it takes this pirate to complete each step (as listed above).<br>At the start, all pirates are queued up at the plank on the pirate ship in the order given in the input  (the first pirate is the first to cross over).</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For every test case in the input, the output should contain one integer on a single line: the time in seconds between the time the first pirate starts crossing the plank and the time the last pirate has crossed the plank carrying the last item.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
3 3
10 3 10 3
10 3 10 3
10 3 10 3
3 2
10 10 10 10
1 9 1 8
3 2
3 2 3 6
4 2 5 5</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">63
50
24</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=BAPC 2011&source=1&searchmode=source'> BAPC 2011 </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4204'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4204'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4204">Discuss</a> | <a href='note/note.php?pid=4204'>Note</a><br></td></tr></div></body></html>