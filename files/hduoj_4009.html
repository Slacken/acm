<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4009</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Transfer water</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 5000/3000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65768/65768 K (Java/Others)<br>Total Submission(s): 2071&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 759<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>XiaoA lives in a village. Last year flood rained the village. So they decide to move the whole village to the mountain nearby this year. There is no spring in the mountain, so each household could only dig a well or build a water line from other household. If the household decide to dig a well,  the  money  for  the  well  is  the  height  of  their  house  multiplies  X  dollar  per  meter.  If  the household decide to build a water line from other household, and if the height of which supply water is not lower than the one which get water, the money of one water line is the Manhattan distance  of  the  two  households  multiplies  Y  dollar  per  meter.  Or  if  the  height  of  which  supply water is lower than the one which get water, a water pump is needed except the water line. Z dollar should be paid for one water pump. In addition,therelation of the households must be considered. Some households may do not allow some other households build a water line from there house. Now  given  the  3©\dimensional  position (a,  b,  c)  of  every  household  the  c  of  which  means height, can you calculate the minimal money the whole village need so that every household has water, or tell the leader if it can¡¯t be done. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Multiple cases. <br>First line of each case contains 4 integers n (1&lt;=n&lt;=1000), the number of the households, X (1&lt;=X&lt;=1000), Y (1&lt;=Y&lt;=1000), Z (1&lt;=Z&lt;=1000). <br>Each of the next n lines contains 3 integers a, b, c means the position of the i©\th households, none of them will exceeded 1000. <br>Then next n lines describe the relation between the households. The n+i+1©\th line describes the relation of the i©\th household. The line will begin with an integer k, and the next k integers are the household numbers that can build a water line from the i©\th household. <br>If n=X=Y=Z=0, the input ends, and no output for that. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>One  integer  in  one  line  for  each  case,  the  minimal  money  the  whole  village  need  so  that every household has water. If the plan does not exist, print ¡°poor XiaoA¡± in one line. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 10 20 30
1 3 2
2 4 1
1 2
2 1 2
0 0 0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">30

<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>In  3©\dimensional  space  Manhattan  distance  of  point  A  (x1,  y1,  z1)  and  B(x2,  y2,  z2)  is |x2©\x1|+|y2©\y1|+|z2©\z1|. 
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=The 36th ACM/ICPC Asia Regional Dalian Site ¡ª¡ª Online Contest&source=1&searchmode=source'> The 36th ACM/ICPC Asia Regional Dalian Site ¡ª¡ª Online Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4009'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4009'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4009">Discuss</a> | <a href='note/note.php?pid=4009'>Note</a><br></td></tr></div></body></html>