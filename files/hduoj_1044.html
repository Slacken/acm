<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 1044</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Collect More Jewels</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 2324&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 421<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>It is written in the Book of The Lady: After the Creation, the cruel god Moloch rebelled against the authority of Marduk the Creator.Moloch stole from Marduk the most powerful of all the artifacts of the gods, the Amulet of Yendor, and he hid it in the dark cavities of Gehennom, the Under World, where he now lurks, and bides his time.<br><br>Your goddess The Lady seeks to possess the Amulet, and with it to gain deserved ascendance over the other gods.<br><br>You, a newly trained Rambler, have been heralded from birth as the instrument of The Lady. You are destined to recover the Amulet for your deity, or die in the attempt. Your hour of destiny has come. For the sake of us all: Go bravely with The Lady!<br><br>If you have ever played the computer game NETHACK, you must be familiar with the quotes above. If you have never heard of it, do not worry. You will learn it (and love it) soon.<br><br>In this problem, you, the adventurer, are in a dangerous dungeon. You are informed that the dungeon is going to collapse. You must find the exit stairs within given time. However, you do not want to leave the dungeon empty handed. There are lots of rare jewels in the dungeon. Try collecting some of them before you leave. Some of the jewels are cheaper and some are more expensive. So you will try your best to maximize your collection, more importantly, leave the dungeon in time.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Standard input will contain multiple test cases. The first line of the input is a single integer T (1 &lt;= T &lt;= 10) which is the number of test cases. T test cases follow, each preceded by a single blank line.<br><br>The first line of each test case contains four integers W (1 &lt;= W &lt;= 50), H (1 &lt;= H &lt;= 50), L (1 &lt;= L &lt;= 1,000,000) and M (1 &lt;= M &lt;= 10). The dungeon is a rectangle area W block wide and H block high. L is the time limit, by which you need to reach the exit. You can move to one of the adjacent blocks up, down, left and right in each time unit, as long as the target block is inside the dungeon and is not a wall. Time starts at 1 when the game begins. M is the number of jewels in the dungeon. Jewels will be collected once the adventurer is in that block. This does not cost extra time.<br><br>The next line contains M integers£¬which are the values of the jewels.<br><br>The next H lines will contain W characters each. They represent the dungeon map in the following notation:<br>&gt; [*] marks a wall, into which you can not move;<br>&gt; [.] marks an empty space, into which you can move;<br>&gt; [@] marks the initial position of the adventurer;<br>&gt; [&lt;] marks the exit stairs;<br>&gt; [A] - [J] marks the jewels.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Results should be directed to standard output. Start each case with &quot;Case #:&quot; on a single line, where # is the case number starting from 1. Two consecutive cases should be separated by a single blank line. No blank line should be produced after the last test case.<br><br>If the adventurer can make it to the exit stairs in the time limit, print the sentence &quot;The best score is S.&quot;, where S is the maximum value of the jewels he can collect along the way; otherwise print the word &quot;Impossible&quot; on a single line.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3

4 4 2 2
100 200
****
*@A*
*B&lt;*
****

4 4 1 2
100 200
****
*@A*
*B&lt;*
****

12 5 13 2
100 200
************
*B.........*
*.********.*
*@...A....&lt;*
************</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1:
The best score is 200.

Case 2:
Impossible

Case 3:
The best score is 300.</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=Asia 2005, Hangzhou (Mainland China), Preliminary&source=1&searchmode=source'> Asia 2005, Hangzhou (Mainland China), Preliminary </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>JGShining</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=1044'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=1044'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=1044">Discuss</a> | <a href='note/note.php?pid=1044'>Note</a><br></td></tr></div></body></html>