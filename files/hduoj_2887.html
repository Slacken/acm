<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2887</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Watering Hole</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 377&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 81<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Farmer John has decided to bring water to his N (2 &lt;= N &lt;= 5,000) pastures which are conveniently numbered 1..N. And He has M (1 &lt;= M &lt;= 25,000) pipes. He may bring water to a pasture either by building a well in that pasture or connecting the pasture via a pipe to another pasture which already has water. <br><br>Digging a well in pasture i costs W_i (1 &lt;= W_i &lt;= 100,000). Connecting pastures i and j with a pipe costs p (1 &lt;= p &lt;= 100,000). Since the length and quality are different, there may be more than one pipes in different costs connecting pasture i and j.<br><br>Luckily, farmer John found there was only one plan to minimize his cost.<br><br>Farmer Jack, farmer John's friend, has P (1 &lt;= P &lt;= 1,000) pipes. He promised that he could give one pipe to Farmer John, and farmer John can use it to connect his pasture i and j. Now, farmer John wants to know how much the minimum amount he will have to pay to water all of his pastures if he chooses one more pipe from Jack.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are serveral cases:<br>Line 1: Three integers: N, M and P<br><br>Lines 2: N space-separated integers; the i-th integer is W_i <br><br>Lines 3..M+3: Three integers: i, j, p. Means a pipe connecting pasture i and j costs p<br><br>Lines M+4..P+M+4: Two Integers: i, j. Farmer Jack can give Farmer John a pipe connecting pasture i and j.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Line 1..P: A single integer denoting the minimum cost of providing all the pastures with water if farmer John chooses the i-th pipe from farmer Jack. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4 6 1
5 4 4 3
1 2 2
1 3 2
1 4 2
2 3 3
2 4 3
3 4 4
3 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">7</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Multi-University Training Contest 9 - Host by HIT&source=1&searchmode=source'> 2009 Multi-University Training Contest 9 - Host by HIT </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>gaojie</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2887'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2887'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2887">Discuss</a> | <a href='note/note.php?pid=2887'>Note</a><br></td></tr></div></body></html>