<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4122</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Alice's mooncake shop</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 784&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 166<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The Mid-Autumn Festival, also known as the Moon Festival or Zhongqiu Festival is a popular harvest festival celebrated by Chinese people, dating back over 3,000 years to moon worship in China's Shang Dynasty. The Zhongqiu Festival is held on the 15th day of the eighth month in the Chinese calendar, which is in September or early October in the Gregorian calendar. It is a date that parallels the autumnal equinox of the solar calendar, when the moon is at its fullest and roundest. <br><center><img src=../../data/images/4122-1.jpg></center> <br>The traditional food of this festival is the mooncake. Chinese family members and friends will gather to admire the bright mid-autumn harvest moon, and eat mooncakes under the moon together. In Chinese, ¡°round¡±(Ô²) also means something like ¡°faultless¡± or ¡°reuion¡±, so the roundest moon, and the round mooncakes make the Zhongqiu Festival a day of family reunion.<br><br>Alice has opened up a 24-hour mooncake shop. She always gets a lot of orders. Only when the time is K o¡¯clock sharp( K = 0,1,2 ¡­. 23) she can make mooncakes, and We assume that making cakes takes no time. Due to the fluctuation of the price of the ingredients, the cost of a mooncake varies from hour to hour. She can make mooncakes when the order comes,or she can make mooncakes earlier than needed and store them in a fridge. The cost to store a mooncake for an hour is S and the storage life of a mooncake is T hours. She now asks you for help to work out a plan to minimize the cost to fulfill the orders.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input contains no more than 10 test cases. <br>For each test case:<br>The first line includes two integers N and M. N is the total number of orders. M is the number of hours the shop opens. <br>The next N lines describe all the orders. Each line is in the following format:<br><br>month date year H R<br><br>It means that on a certain date, a customer orders R mooncakes at H o¡¯clock. ¡°month¡± is in the format of abbreviation, so it could be &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot; or &quot;Dec&quot;. H and R are all integers. <br>All the orders are sorted by the time in increasing order. <br>The next line contains T and S meaning that the storage life of a mooncake is T hours and the cost to store a mooncake for an hour is S.<br>Finally, M lines follow. Among those M lines, the i<sup>th</sup> line( i starts from 1) contains a integer indicating the cost to make a mooncake during the i<sup>th</sup> hour . The cost is no more than 10000. Jan 1st 2000 0 o'clock belongs to the 1<sup>st</sup> hour, Jan 1st 2000 1 o'clock belongs to the 2<sup>nd</sup> hour, ¡­¡­ and so on.<br><br>(0&lt;N &lt;= 2500;  0 &lt; M,T &lt;=100000;  0&lt;=S &lt;= 200;  R&lt;=10000 ; 0&lt;=H&lt;24)<br><br>The input ends with N = 0 and M = 0.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>You should output one line for each test case: the minimum cost. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1 10
Jan 1 2000 9 10
5 2
20 
20 
20 
10 
10
8
7 
9 
5 
10
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">70
<div style='font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px'><div style='font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed'><i>Hint</i></div>
¡°Jan 1 2000 9 10¡± means in Jan 1st 2000 at 9 o'clock , there's a consumer ordering 10 mooncakes. 
Maybe you should use 64-bit signed integers. The answer will fit into a 64-bit signed integer.
</div><i style='font-size:1px'> </i></div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2011 Asia Fuzhou Regional Contest &source=1&searchmode=source'> 2011 Asia Fuzhou Regional Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4122'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4122'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4122">Discuss</a> | <a href='note/note.php?pid=4122'>Note</a><br></td></tr></div></body></html>