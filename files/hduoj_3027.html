<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3027</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Network</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/10000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 98304/98304 K (Java/Others)<br>Total Submission(s): 9&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 2<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>There is a network which is a completely binary tree. In the network, there are 2N users numbered from 1, 2, 3, 4, ... 2N, which are the leaves in the network-tree. For example, Figure 1 is a network-tree. In the tree, there are 8 users (leaf nodes) and 7 transmitters (gray nodes).<br><center><img src=../../../data/images/exe3027-1.JPG></center><br>Using network-tree means that you have to pay a cost for it. The charging way is so interesting, named &quot;pair charging&quot;. The cost you must pay is the sum of cost from every pair of user i and user j ( 1 ¡Ü i &lt; j ¡Ü 2N). Every user can choose mode A or mode B to pay for the charge.<br><br>For every two users i, j (1 ¡Ü i &lt; j ¡Ü 2N), first find their LCA (The Least Common Ancestors): Transmitter P. Then count the number of mode A users in the tree of ROOT transmitter P, so do mode B.<br><br>Next, let's name the number nA and nB and at last charge the cost.<br><br>f[i][j] is the flow between user i and user j.<br><br>The charging way is followed:<br><center><img src=../../../data/images/exe3027-2.JPG></center><br>At first, every user has an initial mode, A or B. However, they want to reduce the cost, so a part of them would change the mode from A to B, or from B to A. Every change will have an extra cost. If user i changes his mode, he will pay Ci cost.<br><br>Now, you should find the minimum cost, that is, the sum of the cost having to pay for and the extra cost of changing mode. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>First line, an integer N (N ¡Ü 10).<br><br>Sencond line, 2N integers, ith integer stands for ith user's initial mode. 0 is mode A, 1 is mode B.<br><br>Third line, 2N integers, ith integer stands for Ci, the cost that ith user changes his mode. (0 ¡Ü Ci ¡Ü 500 000)<br><br>Next 2N - 1 line, describe the flow of every pair of users. The i + 3 th line's (in the whole input) j row's integer standing for the f[i][j + i]. (1 ¡Ü i ¡Ü 2^N ,1 ¡Ü j ¡Ü 2^N - i, 0 ¡Ü f[i][j] ¡Ü 500). </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Only a single integer, standing for the minimum cost above.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 
1 0 1 0 
2 2 10 9
10 1 2 
2 1 
3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">8

Explanation: Changing the user 1's mode from B to A will minimumize the cost. </div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2009 Multi-University Training Contest 6 - Host by WHU&source=1&searchmode=source'> 2009 Multi-University Training Contest 6 - Host by WHU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>gaojie</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3027'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3027'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3027">Discuss</a> | <a href='note/note.php?pid=3027'>Note</a><br></td></tr></div></body></html>