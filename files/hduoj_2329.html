<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2329</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Money Money Money, Must Be Funny</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 9000/3000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 1&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 1<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>* Shopkeeper: ¡°100 crowns and 80 hellers, please.¡±<br>* Customer: ¡°Here you are.¡± (handing a 200-crown banknote)<br>* Shopkeeper: ¡°Would you have 80 hellers?¡± (passing back a 100-crown note)<br>* Customer: ¡°No, but here you are.¡± (adding a 1-crown coin)<br>* Shopkeeper: ¡°Sorry, but have only this.¡± (showing a little shiny 50-heller coin)<br>* Customer: ¡°So I need to give you another 30 heller. But I have only 40.¡±<br>* Shopkeeper: ¡°That¡¯s ok, here are the remaining 10.¡±<br><br>Have you ever experienced similar situations? Paying a precise amount can sometimes be difficult, if the set of available coins and banknotes (¡°tenders¡±) is limited. The situation above was finally solved: The customer paid 200+1 crowns, got 100+0.50 back, paid another 0.20+0.20, and finally got 0.10 back. This means, 7 tenders had to be exchanged. Sometimes, it may be even more complicated. Your task is to write a program that solves situations like this.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Input contains several tasks to be solved. Each task begins with a line containing one nonnegative number: the amount to be paid. Then there is a list of tenders possessed by the customer (the one who pays). Each line in the list contains the tender nominal value (nonnegative number), one space, number of tenders of that value (non-negative integer), and the<br>lowercase letter ¡°x¡±. The list is terminated by a line containing number ¡°-1¡±.<br><br>After the first list, there is a list of tenders possessed by the shopkeeper (the one who gets paid). The second list has the exactly same format as the first one.<br><br>Then the next task begins. The last task is followed by one more line containing ¡°-1¡±.<br><br>You may assume that each list will contain at most 100 lines, and nobody will have more than 10 000 units and/or 500 tenders. Nominal values can be arbitrary, they do not need to follow any existing scheme valid in known countries. All numbers that allow non-integer values will be given either as integers or as decimal numbers with one or two digits after the decimal point.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each task, output one line containing the sentence ¡°X tenders must be exchanged.¡±, with X replaced by the minimal number of tenders that are to be used to pay the required amount. If this is not possible at all, output the sentence ¡°The payment is impossible.¡± instead.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">100.80
500 1x
200 3x
1.00 10x
0.20 2x
-1
500 10x
200 12x
100 8x
0.10 1x
0.20 0x
0.50 100x
20 2x
-1
200
10 19x
-1
200 1x
-1
-1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">7 tenders must be exchanged.
The payment is impossible.</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=CTU Open Contest 2007&source=1&searchmode=source'> CTU Open Contest 2007 </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>teddy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2329'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2329'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2329">Discuss</a> | <a href='note/note.php?pid=2329'>Note</a><br></td></tr></div></body></html>