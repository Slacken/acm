<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4049</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Tourism Planning</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 589&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 253<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Several friends are planning to take tourism during the next holiday. They have selected some places to visit. They have decided which place to start their tourism and in which order to visit these places. However, anyone can leave halfway during the tourism and will never back to the tourism again if he or she is not interested in the following places. And anyone can choose not to attend the tourism if he or she is not interested in any of the places. <br>Each place they visited will cost every person certain amount of money. And each person has a positive value for each place, representing his or her interest in this place. To make things more complicated, if two friends visited a place together, they will get a non negative bonus because they enjoyed each other¡¯s companion. If more than two friends visited a place together, the total bonus will be the sum of each pair of friends¡¯ bonuses.<br>Your task is to decide which people should take the tourism and when each of them should leave so that the sum of the interest plus the sum of the bonuses minus the total costs is the largest. If you can¡¯t find a plan that have a result larger than 0, just tell them to STAY HOME.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several cases. Each case starts with a line containing two numbers N and M ( 1&lt;=N&lt;=10, 1&lt;=M&lt;=10). N is the number of friends and M is the number of places. The next line will contain M integers Pi (1&lt;=i&lt;=M) , 1&lt;=Pi&lt;=1000, representing how much it costs for one person to visit the ith place. Then N line follows, and each line contains M integers Vij (1&lt;=i&lt;=N, 1&lt;=j&lt;=M), 1&lt;=Vij&lt;=1000, representing how much the ith person is interested in the jth place. Then N line follows, and each line contains N integers Bij (1&lt;=i&lt;=N, 1&lt;=j&lt;=N), 0&lt;=Bij&lt;=1000, Bij=0 if i=j, Bij=Bji.<br>A case starting with 0 0 indicates the end of input and you needn¡¯t give an output.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, if you can arrange a plan lead to a positive result, output the result in one line, otherwise, output STAY HOME in one line.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2 1
10
15
5
0 5
5 0
3 2
30 50
24 48
40 70
35 20
0 4 1
4 0 5
1 5 0
2 2
100 100
50 50
50 50
0 20
20 0
0 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5
41
STAY HOME</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=The 36th ACM/ICPC Asia Regional Beijing Site ¡ª¡ª Online Contest &source=1&searchmode=source'> The 36th ACM/ICPC Asia Regional Beijing Site ¡ª¡ª Online Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4049'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4049'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4049">Discuss</a> | <a href='note/note.php?pid=4049'>Note</a><br></td></tr></div></body></html>