<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3632</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>A Captivating Match</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 153&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 64<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>The FIFA 2010 Soccer World Cup has gone, Small Jan returned to her own planet. After she saw the Spain emerged the biggest winner, she believe that, as a Queen, she can also arrange a captivating match-International Cavalry PK Contest(ACM-ICPC) for her lovely and hard working subjects. But her subjects are so busying that they have no time to watch the group match. So, our smart Queen wants to make the final more valuable. Every Knight has a value in people¡¯s minds and the final¡¯s value is dependent on the last valiancy Knights (equals to the winner's value).<br>Now assuming that the Knights have been numbered from 1 to N, and any time Small Jan could arrange a match between any two Knights adjacent to each other, but the loser will quit. For example, (1, 2, 3, 4, 5),if the Queen arranged Knights 3 and 4 for a match and Knight 3 lost, then Knights 2 and 4 would be adjacent to each other (the result of each Knight competing with others is saved in a table). <br>Here, Small Jan want to know the max value of the final, can you help her?</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line of the input is a single positive integer T(0 &lt; T &lt;= 30), telling the number of test scenarios to follow. <br>Each scenario begins with a line containing an integer N, 0 &lt; N &lt;= 100, being the number of Knights. <br>The following line contains N integers, 0 &lt; Vi &lt; 1000, being the value of each Knight in people¡¯s minds. <br>Thelast is a N ¡Á N matrix. If a[i,j] = 1 indicate when Knight  i competing with j, Knight i always win, which also means a[j, i] must equals 0 and if i=j, a[i,j] must equals 0. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each input case, output a line containing a single number, which is the max value of the final, following the case number (start with 1) </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
3
1 2 3
0 1 0
0 0 1
1 0 0
3
1 2 3
0 1 1
0 0 0
0 1 0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 3
Case 2: 1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>Westwind Blows@HDU</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨19£©¡ª¡ªHost by HDU&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨19£©¡ª¡ªHost by HDU </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3632'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3632'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3632">Discuss</a> | <a href='note/note.php?pid=3632'>Note</a><br></td></tr></div></body></html>