<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3303</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Harmony Forever</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 20000/10000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 502&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 115<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>We believe that every inhabitant of this universe eventually will find a way to live together in harmony and peace; that trust, patience, kindness and loyalty will exist between every living being of this earth; people will find a way to appreciate and cooperate with each other instead of continuous bickering, arguing and fighting. Harmony -- the stage of society so many people dream of and yet it seems so far away from now ...<br><br>Fortunately, the method of unlocking the key to true Harmony is just discovered by a group of philosophers. It is recorded on a strange meteorite which has just hit the earth. You need to decipher the true meaning behind those seemingly random symbols ... More precisely, you are to write a program which will support the following two kinds of operation on an initially empty set S :<br><br>1.<br>    B X : Add number X to set S . The Kth command in the form of B X always happens at time K , and number X does not belong to set S before this operation. <br>2.<br>    A Y : Of all the numbers in set S currently, find the one which has the minimum remainder when divided by Y . In case a tie occurs, you should choose the one which appeared latest in the input. Report the time when this element is inserted. <br><br>It is said that if the answer can be given in the minimum possible time, true Harmony can be achieved by human races. You task is to write a program to help us. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are multiple test cases in the input file. Each test case starts with one integer T  where 1&lt;=T&lt;=40000 . The following T  lines each describe an operation, either in the form of ``B X &quot; or ``A Y &quot; where 1&lt;=X , Y&lt;=500000 .<br><br>T = 0 indicates the end of input file and should not be processed by your program. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Print the result of each test case in the format as indicated in the sample output. For every line in the form of ``A Y &quot;, you should output one number, the requested number, on a new line; output -1 if no such number can be found. Separate the results of two successive inputs with one single blank line.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">5 
B 1 
A 5 
B 10 
A 5 
A 40 
2 
B 1 
A 2
0</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 
1 
2 
1 

Case 2: 
1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2006 Asia Regional Shanghai &source=1&searchmode=source'> 2006 Asia Regional Shanghai  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3303'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3303'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3303">Discuss</a> | <a href='note/note.php?pid=3303'>Note</a><br></td></tr></div></body></html>