<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2766</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Equilibrium Mobile</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 240&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 65<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content><center><img src=../../../data/images/C179-1001-1.jpg></center><br>A mobile is a type of kinetic sculpture constructed to take advantage of the principle of equilibrium. It consists of a number of rods, from which weighted objects or further rods hang. The objects hanging from the rods balance each other, so that the rods remain more or less horizontal. Each rod hangs from only one string, which gives it freedom to rotate about the string.<br><br>We consider mobiles where each rod is attached to its string exactly in the middle, as in the figure underneath. You are given such a configuration, but the weights on the ends are chosen incorrectly, so that the mobile is not in equilibrium. Since that's not aesthetically pleasing, you decide to change some of the weights. <br><center><img src=../../../data/images/C179-1001-2.jpg></center><br><br>What is the minimum number of weights that you must change in order to bring the mobile to equilibrium? You may substitute any weight by any (possibly non-integer) weight. For the mobile shown in the figure, equilibrium can be reached by changing the middle weight from 7 to 3, so only 1 weight needs to changed. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>On the first line one positive number: the number of testcases, at most 100. After that per testcase:<br><br>    * One line with the structure of the mobile, which is a recursively defined expression of the form:<br><br>        &lt;expr&gt; ::= &lt;weight&gt; | &quot;[&quot; &lt;expr&gt; &quot;,&quot; &lt;expr&gt; &quot;]&quot;<br><br>      with &lt;weight&gt; a positive integer smaller than 109 indicating a weight and [&lt;expr&gt;,&lt;expr&gt;] indicating a rod with the two expressions at the ends of the rod. The total number of rods in the chain from a weight to the top of the mobile will be at most 16. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>Per testcase:<br><br>    * One line with the minimum number of weights that have to be changed. </div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
[[3,7],6]
40
[[2,3],[4,5]]</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
0
3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=NWERC 2008&source=1&searchmode=source'> NWERC 2008 </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2766'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2766'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2766">Discuss</a> | <a href='note/note.php?pid=2766'>Note</a><br></td></tr></div></body></html>