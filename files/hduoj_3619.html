<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3619</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Heroes of Might and Magic</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 132&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 57<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>After a very long journey and uncountable number of uphill battles, hero Raelag (who is the transformed Agrael, notice that &quot;Raelag&quot; is an anagram of &quot;Agrael&quot;) finally find the map shows where the &quot;Holy Cap&quot; is. Now he is going to find the treasure. <br><br>The map is made up of squares of equal size which are arranged in r rows and c columns. At the beginning, Raelag is at the square Labeled 'S', and the &quot;Holy Cap&quot; is at the square Labeled 'T'. It is guarranteed that there is only one 'S' and only one 'T' in a map. Squares that labeled with '#' in the map means squares that can't be passed; '.' means roads that can be passed without any physical loss and squares that labeled with an integer i (1 ¡Ü i ¡Ü 9) means when Raelag pass through this square, he will suffer i points of physical loss. Squares that labeled with capital letter 'A', 'B', 'C', 'D' or 'E' means doors that can be passed only if Raelag has the right key (There are at most 5 kinds of doors in a map). The squares labeled with 'S', 'T' and other capital letters all can be passed with out physical loss. Raelag can move to squares only if that square share an edge with the square he is now in. Raelag can't move out of the map. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The fist line of input file contains a single integer T (1 ¡Ü T ¡Ü 10) - the number of test cases. For each test case, in the first line their are three integers: r, c and k (1 ¡Ü r, c ¡Ü 50, 0 ¡Ü k ¡Ü 5), representing the hight, length of the map and the number of kinds of doors in the map. Then there are r lines giving the map. Then k lines follows giving the position of the keys to the door 'A', 'B', 'C', 'D', and 'E' in order. <br><br>The uperleft conner is row 1 and colomn 1. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case, output a single integer: the minimum points of physical lose Raelag needs to suffer to find the &quot;Holy Cup&quot;. If he can't find the &quot;Holy Cap&quot; any way, output &quot;-1&quot;. <br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
3 3 1
S21
#A#
11T
1 3
3 5 2
S..A.
##.##
.B.AT
3 1
1 5</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">6
-1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨18£©¡ª¡ªHost by TJU &source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨18£©¡ª¡ªHost by TJU  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3619'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3619'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3619">Discuss</a> | <a href='note/note.php?pid=3619'>Note</a><br></td></tr></div></body></html>