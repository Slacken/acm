<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3190</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Marriage Match</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 6000/2000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 20&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 9<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>You may know the funny problem ¡°The Stable Marriage Problem¡±. Now let¡¯s find a new match algorithm. <br>Firstly the women and men stand in a line separately and each woman will choose the man she likes.<br>Then it¡¯s your task to make a match for these people. You should choose m women and m men from the initial queues. Let them stand in a line separately by initial order.  If the woman stands in the ith place do not like the man stands in the ith place, the match is unacceptable. To increase the possibility of the match, the women can accept the men their friends like. Please find out the maximal m.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>There are several test cases.<br>Each test case starts with two integer p and q in a line means the number of women and the number of men.(0 &lt; p , q &lt;= 100000)<br>Then a line with p numbers follows means the queue of women. (The id ranges from 1 to p)<br>Then a line with q numbers follows means the queue of men. (The id ranges from 1 to q)<br>Then a line with p numbers which means the man the ith woman likes.<br>Then a line with an integer t, means the number of friendships between women.(0 &lt; t &lt; 100000)<br>Then t lines follow. Each line contains two numbers a and b means a and b are friends.(a!=b, 1 &lt;= a, b &lt;= p)<br>You may support the friendship can transmit. If a and b are friends and c and b are friends, then a and c are friends. Notice every woman will have no more than five friends.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, output the maximal m in one line.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">4 4
1 3 2 4
1 4 2 3
2 3 1 2
2
1 2
3 4</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=HDU 2009-11 Programming Contest&source=1&searchmode=source'> HDU 2009-11 Programming Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3190'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3190'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3190">Discuss</a> | <a href='note/note.php?pid=3190'>Note</a><br></td></tr></div></body></html>