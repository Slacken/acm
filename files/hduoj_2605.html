<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 2605</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Snake</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/6000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 107&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 29<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Snake is a popular game , and I believe most of us had played it . The Original game is that you can control a snake to eat the magic bean and after the snake eat one magic bean , the length of the snake¡¯s body will get longer .But today we are talking about a new game. These are the rules of the new Snake Game :<br>1. The length of the snake¡¯s body won¡¯t change even though it eat a magic bean.<br>2. Some pairs of the beans have a relation , that is, one of them can not be eaten until another one had been eaten . We call the latter ¡°the key bean¡± . For example , if A can¡¯t be eaten until B had been eaten ,we say ¡°B is the key bean of A¡±. (That means when A can¡¯t be eaten , the snake can not move into the grid where A is.)<br>3. The snake could not move to a wall or its body.Befor it move,it will chooses an adjacent vacant square of its head,which is neither a stone nor occupied by its body.<br><center>Figure 1 and figure2 shows how the snake move</center><br><center><img src=../../../data/images/C154-1006-1.jpg> </center><br><center>Figure 1</center><br><center><img src=../../../data/images/C154-1006-2.jpg> </center><br><center>Figure 2</center><br><br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The first line contain a integer T (T &lt;= 10).Followed by T cases. Each case contain five parts.<br>The first part: six integers ,H,W,L,K,R,N,(H &lt;= 20 , W &lt;= 20 , L &lt;= 8 , K &lt;= 7 ) means the height of the map , the width of the map , the length of the snake¡¯s body, the number of the magic beans . the number of the relations , the number of the wall respectively.<br>The second part: L lines , each line contain two integer h<sub>i</sub> ,w<sub>i</sub>, indicating the original position of each block of snake's body, from B<sub>1</sub>(h<sub>1</sub>,w<sub>1</sub>) to B<sub>L</sub>(h<sub>L</sub>,w<sub>L</sub>) orderly, where 1&lt;=h<sub>i</sub>&lt;=H, and 1&lt;=w<sub>i</sub>&lt;=W,1&lt;=i&lt;=L.<br>The third part: K lines ,each line contain two integer h<sub>i</sub> ,w<sub>i</sub> , indicating the position of each magic bean , from MB<sub>1</sub>(h<sub>1</sub>,w<sub>1</sub>) to MB<sub>K</sub>(h<sub>K</sub>,w<sub>K</sub>) orderly, where 1&lt;=h<sub>i</sub>&lt;=H, and 1&lt;=w<sub>i</sub>&lt;=W,1&lt;=i&lt;=K.<br>The fourth part : R lines , each line contain two integer A ,B means ¡°A is the key bean of B ¡±. The A and B may appear several times , but ¡°one bean will have only one key bean¡±.<br>The fifth part: N lines , each line contain two integer h<sub>i</sub> ,w<sub>i</sub> , indicating the position of each wall , from W<sub>1</sub>(h<sub>1</sub>,w<sub>1</sub>) to W<sub>N</sub>(h<sub>N</sub>,w<sub>N</sub>) orderly, where 1&lt;=h<sub>i</sub>&lt;=H, and 1&lt;=w<sub>i</sub>&lt;=W,1&lt;=i&lt;=N.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case , if the snake could eat all the magic beans , output the minimum step it took. If the snake could not , just output ¡°-1¡± (without the quotation marks) .<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
8 9
5 2
1 8
5 2
6 2
6 3
6 4
6 5
4 2
2 6
2 1
2 5
3 5
4 4
4 5
4 6
5 6
5 7
6 7</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">21</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>Teddy</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=HDU 1st ¡°Vegetable-Birds Cup¡± Programming Open Contest&source=1&searchmode=source'> HDU 1st ¡°Vegetable-Birds Cup¡± Programming Open Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=2605'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=2605'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=2605">Discuss</a> | <a href='note/note.php?pid=2605'>Note</a><br></td></tr></div></body></html>