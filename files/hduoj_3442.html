<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3442</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Three Kingdoms</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 780&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 311<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Three Kingdoms is a funny game. Often Liu Bei is weak and has to run away,so in the game Liu Bei has a skill called &quot;Dunzou&quot;. This time you are playing the role of Liu Bei.As Cao Cao's power is so strong, there is nothing  you can do but escaping. Please select an optimal path to achieve the purpose .<center><img src=../../data/images/3442-1.jpg></center>To simplify the problem, Liu Bei can only move in one of the four direction (up, down,right,left) each time. The map contains the following characters:<br>¡®A¡¯ : Representative of watchtower, which has an attack range of  2(measured by Manhattan distance),and an attack damage of 1.<br>¡®B¡¯ : Representative of Fort, which has an attack range of 3(measured by Manhattan distance),and an attack damage of 2.<br>¡®C¡¯ : Representative of Flame, which has an attack damage of 3 to those who step onto it. <br>¡®D¡¯ : Representative of Archer, which has anattack range of 2(measured by Manhattan distance), and an attack damage of 4.<br>¡®E¡¯ : Representative of Ordinary soldier, which has anattack range of 1(measured by Manhattan distance), and an attack damage of 5.<br>¡®$¡¯ : Representative of Liu Bei.<br>¡®!¡¯ : Representative of Destination.<br>'#' : Representative of obstacles<br>¡®.¡¯ : Representative of floor.<br>Liu Bei can not enter watchtower, forts, Archers, ordinary soldiers,But he can step onto flame or floor.<br>Some important rules you should note:<br>1.&nbsp;&nbsp;Liu Bei will not be hurt by the same thing twice.For example,if Liu Bei has been hurt by one watchtower before,then he step into the attack range of some watchtower later,he will not be hurt. <br>2.&nbsp;&nbsp;When Liu Bei reach the destination,you should first judge the attack damage at the destination then finish the game.<br>3.&nbsp;&nbsp;You needn¡¯t judge the attack damage at the start position.<br> Please choose a path which LiuBei would cost the least HP.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>In the first line there is an integer T, indicates the number of test cases.(T&lt;=60)<br>In each case,the first line of the input contains two integer n,m(1&lt;=n,m&lt;=50),reperesenting the size of map(n*m).Then follow n lines,each line contain m characters.<br>There may be some blank lines between each case.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each test case , output ¡°Case d:  ¡° where d is the case number counted from one.If Liu Bei can reach the destination then output the minimum HP LiuBei may lose, otherwise output -1.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">1
4 3
.$.
ACB
ACB
.!.</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">Case 1: 6</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>jwq</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ACM-ICPC Multi-University Training Contest£¨1£©¡ª¡ªHost by FZU&source=1&searchmode=source'> 2010 ACM-ICPC Multi-University Training Contest£¨1£©¡ª¡ªHost by FZU </a> </div> <div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3442'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3442'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3442">Discuss</a> | <a href='note/note.php?pid=3442'>Note</a><br></td></tr></div></body></html>