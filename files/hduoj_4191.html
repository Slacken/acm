<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4191</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Game, Set and Match</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65536/32768 K (Java/Others)<br>Total Submission(s): 7&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 6<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>In this problem you need to assist in computing the probability of winning at tennis. Here is a brief explanation of how the scoring system works. In a tennis <i>match</i>, players play a certain number of consecutive <i>sets</i>. Each <i>set</i> is in turn made up of a series of <i>games</i> (and may include a <i>tie-break</i> if needed). Finally each game is made of <i>points</i>. <br><br><strong>Points.</strong> Every point is started by one of the players serving (i.e. hitting the ball into the service box in the opposite court) and the other receiving serve. The server then attempts to return the ball into the server's<br>court and players alternate hitting the ball across the net. When one of the players fails to make a legal return (e.g. if the ball is knocked out of the court), he or she loses the point. The specics of how points are won are not important to us.<br><br><strong>Games.</strong> The scoring system within a game is peculiar to say the least. As the player wins points in a game, his score goes from the initial value of 0 (read &quot;love&quot;) to 15, 30, or 40 (yes, just when you think you're starting to spot a pattern in this mess it breaks down). There is no a-priori limit to the length of a game (meaning the number of points played), but a player's score is always indicated by one of these numbers according to the following rules. When a player has three points (score 40) and wins the following point as well, he wins the game unless the scoreline was 40-40 (read &quot;deuce&quot;) to start with. A player needs to win two consecutive points from deuce to win the game. Winning one gives him advantage; if followed by a second winning point the game is won by him, but if followed by a losing point the score reverts to deuce.<br>    Example: at 40-30, if the first player wins the next point he wins the game. However, if the second player wins the next three points the game is his.<br><br><strong>Sets.</strong> A player wins a set if he wins at least four games (in the current set) and he is two games ahead of his opponent but, as you may be starting to suspect, there is yet another exception. In case the scoreline for the number of games won reaches six-all (6-6), a tie-break is played instead to decide the set.<br>    Example: at 5-4, if the first player wins the next game he takes the set 6-4. But if he loses, the set is still undecided and can eventually go to either 7-5, 5-7 or a tie-break. <br><br><strong>Tie-break.</strong> A tie-break (and the set to which it belongs) is won when a player wins at least seven points by a margin of two points or more.<br><br><strong>Match. </strong>The winner of a match is the rst player to win 2 sets (the wins do not need to be consecutive). Hence a match may go to 2 or 3 sets depending on how the game develops.<br><br>    Rafa has been carefully studying his past performances against his next opponent and he knows he wins each point with probability precisely p, irrespective of whether he is serving or receiving and regardless of all other points played. Can you help him assess his chances of winning the match?</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>    Each test case is described by a single floating point number p, 0&lt;=p&lt;=1 in its own line. A value of -1 for p marks the end of the input.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>    For each test case, print a single line with the probabilities of Rafa winning a given game, set and match,respectively. These three numbers must be separated by a space character. Your answers should be accurate to within an absolute error of 10<sup>-6</sup>.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">0.5
0.3
0.7
-1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">0.50000000000 0.50000000000 0.50000000000
0.09921103448 0.00016770463 0.00000008437
0.90078896552 0.99983229537 0.99999991563</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=SWERC 2011&source=1&searchmode=source'> SWERC 2011 </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4191'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4191'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4191">Discuss</a> | <a href='note/note.php?pid=4191'>Note</a><br></td></tr></div></body></html>