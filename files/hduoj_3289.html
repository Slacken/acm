<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 3289</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Magic tree </h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/5000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65535/32768 K (Java/Others)<br>Total Submission(s): 109&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 41<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content>Sailormoon girls have a beautiful garden, though there is only a tree in it. The tree is quite magic that it will grow different fruits to fit gilrs' demands (xq likes bananas best, wj prefers to kiwi fruits and lff loves tomatoes).<br>Besides these, the tree has N forks which are connected by branches, girls mark the forks by 1 to N and the root is always marked by 1. Fruits will grow on the forks and every fork will grow several fruits. But the tree is too strange that it has many branches(even between two nodes may have more than one branch). In order to pick fruits more convenient and watch more clearly, Sailormoon girls want to cut extra branches by using minimum cost, after that, they also want to know how many fruits are there in a sub-tree. The trouble is that the tree will grow new fruits and girls will pick up some ones from the tree. Can you help them?</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>Input contains multiple cases. Each case contains several lines.<br>The first line contains two integers N, M(N&lt;=100,000, M&lt;=151,000), representing the number of forks and the number of branches in the tree. <br>The following M lines each has three integers u, v and c, which means fork u and fork v are connected by a branch, if you want to cut it, you have to cost c (arbitrary two c will be different, c&lt;=200,000).<br>The next line contains an integer P, representing the operations following.<br>&quot;G x y&quot; which means the fork x will grow y more fruits ;<br>&quot;C x&quot; which means girls will pick all fruits on the fork x;<br>&quot;Q x&quot; which means girls want to know the number of fruits in the sub-tree above the fork x, including the fruits (if exists) on the fork x.<br>Note the tree is empty at the beginning, every number will not exceed the range of integer.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For every &quot;Q x&quot;, output the answer per line.</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3 2
1 2 4
1 3 5
7
G 1 1
G 2 1
G 3 1
Q 1
C 2
Q 2
Q 3</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">3
0
1</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Author</div> <div class=panel_content>wangjing1111</div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=2010 ¡°HDU-Sailormoon¡± Programming Contest&source=1&searchmode=source'> 2010 ¡°HDU-Sailormoon¡± Programming Contest </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=3289'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=3289'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=3289">Discuss</a> | <a href='note/note.php?pid=3289'>Note</a><br></td></tr></div></body></html>